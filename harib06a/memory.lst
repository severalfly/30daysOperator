     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_io_load_eflags
     7 00000000                                 	EXTERN	_io_store_eflags
     8 00000000                                 	EXTERN	_load_cr0
     9 00000000                                 	EXTERN	_store_cr0
    10 00000000                                 [FILE "memory.c"]
    11                                          [SECTION .data]
    12 00000000                                 _keytable:
    13 00000000 00                              	DB	0
    14 00000001 00                              	DB	0
    15 00000002 31                              	DB	49
    16 00000003 32                              	DB	50
    17 00000004 33                              	DB	51
    18 00000005 34                              	DB	52
    19 00000006 35                              	DB	53
    20 00000007 36                              	DB	54
    21 00000008 37                              	DB	55
    22 00000009 38                              	DB	56
    23 0000000A 39                              	DB	57
    24 0000000B 30                              	DB	48
    25 0000000C 2D                              	DB	45
    26 0000000D 5E                              	DB	94
    27 0000000E 00                              	DB	0
    28 0000000F 00                              	DB	0
    29 00000010 51                              	DB	81
    30 00000011 57                              	DB	87
    31 00000012 45                              	DB	69
    32 00000013 52                              	DB	82
    33 00000014 54                              	DB	84
    34 00000015 59                              	DB	89
    35 00000016 55                              	DB	85
    36 00000017 49                              	DB	73
    37 00000018 4F                              	DB	79
    38 00000019 50                              	DB	80
    39 0000001A 40                              	DB	64
    40 0000001B 5B                              	DB	91
    41 0000001C 00                              	DB	0
    42 0000001D 00                              	DB	0
    43 0000001E 41                              	DB	65
    44 0000001F 53                              	DB	83
    45 00000020 44                              	DB	68
    46 00000021 46                              	DB	70
    47 00000022 47                              	DB	71
    48 00000023 48                              	DB	72
    49 00000024 4A                              	DB	74
    50 00000025 4B                              	DB	75
    51 00000026 4C                              	DB	76
    52 00000027 3B                              	DB	59
    53 00000028 3A                              	DB	58
    54 00000029 00                              	DB	0
    55 0000002A 00                              	DB	0
    56 0000002B 5D                              	DB	93
    57 0000002C 5A                              	DB	90
    58 0000002D 58                              	DB	88
    59 0000002E 43                              	DB	67
    60 0000002F 56                              	DB	86
    61 00000030 42                              	DB	66
    62 00000031 4E                              	DB	78
    63 00000032 4D                              	DB	77
    64 00000033 2C                              	DB	44
    65 00000034 2E                              	DB	46
    66 00000035 2F                              	DB	47
    67 00000036 00                              	DB	0
    68 00000037 2A                              	DB	42
    69 00000038 00                              	DB	0
    70 00000039 20                              	DB	32
    71 0000003A 00                              	DB	0
    72 0000003B 00                              	DB	0
    73 0000003C 00                              	DB	0
    74 0000003D 00                              	DB	0
    75 0000003E 00                              	DB	0
    76 0000003F 00                              	DB	0
    77 00000040 00                              	DB	0
    78 00000041 00                              	DB	0
    79 00000042 00                              	DB	0
    80 00000043 00                              	DB	0
    81 00000044 00                              	DB	0
    82 00000045 00                              	DB	0
    83 00000046 00                              	DB	0
    84 00000047 37                              	DB	55
    85 00000048 38                              	DB	56
    86 00000049 39                              	DB	57
    87 0000004A 2D                              	DB	45
    88 0000004B 34                              	DB	52
    89 0000004C 35                              	DB	53
    90 0000004D 36                              	DB	54
    91 0000004E 2B                              	DB	43
    92 0000004F 31                              	DB	49
    93 00000050 32                              	DB	50
    94 00000051 33                              	DB	51
    95 00000052 30                              	DB	48
    96 00000053 2E                              	DB	46
    97                                          [SECTION .text]
    98 00000000                                 	GLOBAL	_memman_init
    99 00000000                                 _memman_init:
   100 00000000 55                              	PUSH	EBP
   101 00000001 89 E5                           	MOV	EBP,ESP
   102 00000003 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   103 00000006 C7 00 00000000                  	MOV	DWORD [EAX],0
   104 0000000C C7 40 04 00000000               	MOV	DWORD [4+EAX],0
   105 00000013 C7 40 08 00000000               	MOV	DWORD [8+EAX],0
   106 0000001A C7 40 0C 00000000               	MOV	DWORD [12+EAX],0
   107 00000021 5D                              	POP	EBP
   108 00000022 C3                              	RET
   109 00000023                                 	GLOBAL	_memman_total
   110 00000023                                 _memman_total:
   111 00000023 55                              	PUSH	EBP
   112 00000024 31 C0                           	XOR	EAX,EAX
   113 00000026 89 E5                           	MOV	EBP,ESP
   114 00000028 31 D2                           	XOR	EDX,EDX
   115 0000002A 53                              	PUSH	EBX
   116 0000002B 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   117 0000002E 8B 0B                           	MOV	ECX,DWORD [EBX]
   118 00000030 39 C8                           	CMP	EAX,ECX
   119 00000032 73 09                           	JAE	L9
   120 00000034                                 L7:
   121 00000034 03 44 D3 14                     	ADD	EAX,DWORD [20+EBX+EDX*8]
   122 00000038 42                              	INC	EDX
   123 00000039 39 CA                           	CMP	EDX,ECX
   124 0000003B 72 F7                           	JB	L7
   125 0000003D                                 L9:
   126 0000003D 5B                              	POP	EBX
   127 0000003E 5D                              	POP	EBP
   128 0000003F C3                              	RET
   129 00000040                                 	GLOBAL	_memman_alloc
   130 00000040                                 _memman_alloc:
   131 00000040 55                              	PUSH	EBP
   132 00000041 31 C9                           	XOR	ECX,ECX
   133 00000043 89 E5                           	MOV	EBP,ESP
   134 00000045 57                              	PUSH	EDI
   135 00000046 56                              	PUSH	ESI
   136 00000047 53                              	PUSH	EBX
   137 00000048 8B 75 0C                        	MOV	ESI,DWORD [12+EBP]
   138 0000004B 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   139 0000004E 8B 03                           	MOV	EAX,DWORD [EBX]
   140 00000050 39 C1                           	CMP	ECX,EAX
   141 00000052 73 0D                           	JAE	L24
   142 00000054                                 L22:
   143 00000054 8B 54 CB 14                     	MOV	EDX,DWORD [20+EBX+ECX*8]
   144 00000058 39 F2                           	CMP	EDX,ESI
   145 0000005A 73 0C                           	JAE	L26
   146 0000005C 41                              	INC	ECX
   147 0000005D 39 C1                           	CMP	ECX,EAX
   148 0000005F 72 F3                           	JB	L22
   149 00000061                                 L24:
   150 00000061 31 C0                           	XOR	EAX,EAX
   151 00000063                                 L10:
   152 00000063 5B                              	POP	EBX
   153 00000064 5E                              	POP	ESI
   154 00000065 5F                              	POP	EDI
   155 00000066 5D                              	POP	EBP
   156 00000067 C3                              	RET
   157 00000068                                 L26:
   158 00000068 8B 7C CB 10                     	MOV	EDI,DWORD [16+EBX+ECX*8]
   159 0000006C 8D 04 3E                        	LEA	EAX,DWORD [ESI+EDI*1]
   160 0000006F 89 44 CB 10                     	MOV	DWORD [16+EBX+ECX*8],EAX
   161 00000073 89 D0                           	MOV	EAX,EDX
   162 00000075 29 F0                           	SUB	EAX,ESI
   163 00000077 89 44 CB 14                     	MOV	DWORD [20+EBX+ECX*8],EAX
   164 0000007B 85 C0                           	TEST	EAX,EAX
   165 0000007D 75 1B                           	JNE	L16
   166 0000007F 8B 33                           	MOV	ESI,DWORD [EBX]
   167 00000081 39 F1                           	CMP	ECX,ESI
   168 00000083 73 15                           	JAE	L16
   169 00000085                                 L21:
   170 00000085 8B 44 CB 18                     	MOV	EAX,DWORD [24+EBX+ECX*8]
   171 00000089 8B 54 CB 1C                     	MOV	EDX,DWORD [28+EBX+ECX*8]
   172 0000008D 89 44 CB 10                     	MOV	DWORD [16+EBX+ECX*8],EAX
   173 00000091 89 54 CB 14                     	MOV	DWORD [20+EBX+ECX*8],EDX
   174 00000095 41                              	INC	ECX
   175 00000096 39 F1                           	CMP	ECX,ESI
   176 00000098 72 EB                           	JB	L21
   177 0000009A                                 L16:
   178 0000009A 89 F8                           	MOV	EAX,EDI
   179 0000009C EB C5                           	JMP	L10
   180 0000009E                                 	GLOBAL	_memman_free
   181 0000009E                                 _memman_free:
   182 0000009E 55                              	PUSH	EBP
   183 0000009F 89 E5                           	MOV	EBP,ESP
   184 000000A1 57                              	PUSH	EDI
   185 000000A2 56                              	PUSH	ESI
   186 000000A3 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   187 000000A6 53                              	PUSH	EBX
   188 000000A7 31 DB                           	XOR	EBX,EBX
   189 000000A9 8B 3E                           	MOV	EDI,DWORD [ESI]
   190 000000AB 39 FB                           	CMP	EBX,EDI
   191 000000AD 7D 0E                           	JGE	L29
   192 000000AF                                 L33:
   193 000000AF 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   194 000000B2 39 44 DE 10                     	CMP	DWORD [16+ESI+EBX*8],EAX
   195 000000B6 77 05                           	JA	L29
   196 000000B8 43                              	INC	EBX
   197 000000B9 39 FB                           	CMP	EBX,EDI
   198 000000BB 7C F2                           	JL	L33
   199 000000BD                                 L29:
   200 000000BD 85 DB                           	TEST	EBX,EBX
   201 000000BF 7E 0F                           	JLE	L34
   202 000000C1 8B 54 DE 0C                     	MOV	EDX,DWORD [12+ESI+EBX*8]
   203 000000C5 8B 44 DE 08                     	MOV	EAX,DWORD [8+ESI+EBX*8]
   204 000000C9 01 D0                           	ADD	EAX,EDX
   205 000000CB 3B 45 0C                        	CMP	EAX,DWORD [12+EBP]
   206 000000CE 74 73                           	JE	L57
   207 000000D0                                 L34:
   208 000000D0 39 FB                           	CMP	EBX,EDI
   209 000000D2 7D 0C                           	JGE	L43
   210 000000D4 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   211 000000D7 03 45 10                        	ADD	EAX,DWORD [16+EBP]
   212 000000DA 3B 44 DE 10                     	CMP	EAX,DWORD [16+ESI+EBX*8]
   213 000000DE 74 53                           	JE	L58
   214 000000E0                                 L43:
   215 000000E0 81 FF 00000FF9                  	CMP	EDI,4089
   216 000000E6 7F 3D                           	JG	L45
   217 000000E8 89 F9                           	MOV	ECX,EDI
   218 000000EA 39 DF                           	CMP	EDI,EBX
   219 000000EC 7E 15                           	JLE	L55
   220 000000EE                                 L50:
   221 000000EE 8B 44 CE 08                     	MOV	EAX,DWORD [8+ESI+ECX*8]
   222 000000F2 8B 54 CE 0C                     	MOV	EDX,DWORD [12+ESI+ECX*8]
   223 000000F6 89 44 CE 10                     	MOV	DWORD [16+ESI+ECX*8],EAX
   224 000000FA 89 54 CE 14                     	MOV	DWORD [20+ESI+ECX*8],EDX
   225 000000FE 49                              	DEC	ECX
   226 000000FF 39 D9                           	CMP	ECX,EBX
   227 00000101 7F EB                           	JG	L50
   228 00000103                                 L55:
   229 00000103 8D 47 01                        	LEA	EAX,DWORD [1+EDI]
   230 00000106 89 06                           	MOV	DWORD [ESI],EAX
   231 00000108 39 46 04                        	CMP	DWORD [4+ESI],EAX
   232 0000010B 7D 03                           	JGE	L51
   233 0000010D 89 46 04                        	MOV	DWORD [4+ESI],EAX
   234 00000110                                 L51:
   235 00000110 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   236 00000113 89 44 DE 10                     	MOV	DWORD [16+ESI+EBX*8],EAX
   237 00000117 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   238 0000011A 89 44 DE 14                     	MOV	DWORD [20+ESI+EBX*8],EAX
   239 0000011E                                 L56:
   240 0000011E 31 C0                           	XOR	EAX,EAX
   241 00000120                                 L27:
   242 00000120 5B                              	POP	EBX
   243 00000121 5E                              	POP	ESI
   244 00000122 5F                              	POP	EDI
   245 00000123 5D                              	POP	EBP
   246 00000124 C3                              	RET
   247 00000125                                 L45:
   248 00000125 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   249 00000128 FF 46 0C                        	INC	DWORD [12+ESI]
   250 0000012B 01 46 08                        	ADD	DWORD [8+ESI],EAX
   251 0000012E 83 C8 FF                        	OR	EAX,-1
   252 00000131 EB ED                           	JMP	L27
   253 00000133                                 L58:
   254 00000133 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   255 00000136 89 44 DE 10                     	MOV	DWORD [16+ESI+EBX*8],EAX
   256 0000013A 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   257 0000013D 01 44 DE 14                     	ADD	DWORD [20+ESI+EBX*8],EAX
   258 00000141 EB DB                           	JMP	L56
   259 00000143                                 L57:
   260 00000143 03 55 10                        	ADD	EDX,DWORD [16+EBP]
   261 00000146 89 54 DE 0C                     	MOV	DWORD [12+ESI+EBX*8],EDX
   262 0000014A 3B 1E                           	CMP	EBX,DWORD [ESI]
   263 0000014C 7D D0                           	JGE	L56
   264 0000014E 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   265 00000151 03 45 10                        	ADD	EAX,DWORD [16+EBP]
   266 00000154 3B 44 DE 10                     	CMP	EAX,DWORD [16+ESI+EBX*8]
   267 00000158 75 C4                           	JNE	L56
   268 0000015A 03 54 DE 14                     	ADD	EDX,DWORD [20+ESI+EBX*8]
   269 0000015E 89 54 DE 0C                     	MOV	DWORD [12+ESI+EBX*8],EDX
   270 00000162 8B 06                           	MOV	EAX,DWORD [ESI]
   271 00000164 48                              	DEC	EAX
   272 00000165 89 06                           	MOV	DWORD [ESI],EAX
   273 00000167 39 C3                           	CMP	EBX,EAX
   274 00000169 7D B3                           	JGE	L56
   275 0000016B 89 C1                           	MOV	ECX,EAX
   276 0000016D                                 L42:
   277 0000016D 8B 44 DE 18                     	MOV	EAX,DWORD [24+ESI+EBX*8]
   278 00000171 8B 54 DE 1C                     	MOV	EDX,DWORD [28+ESI+EBX*8]
   279 00000175 89 44 DE 10                     	MOV	DWORD [16+ESI+EBX*8],EAX
   280 00000179 89 54 DE 14                     	MOV	DWORD [20+ESI+EBX*8],EDX
   281 0000017D 43                              	INC	EBX
   282 0000017E 39 CB                           	CMP	EBX,ECX
   283 00000180 7C EB                           	JL	L42
   284 00000182 EB 9A                           	JMP	L56
   285 00000184                                 	GLOBAL	_memtest
   286 00000184                                 _memtest:
   287 00000184 55                              	PUSH	EBP
   288 00000185 89 E5                           	MOV	EBP,ESP
   289 00000187 56                              	PUSH	ESI
   290 00000188 53                              	PUSH	EBX
   291 00000189 31 F6                           	XOR	ESI,ESI
   292 0000018B E8 [00000000]                   	CALL	_io_load_eflags
   293 00000190 0D 00040000                     	OR	EAX,262144
   294 00000195 50                              	PUSH	EAX
   295 00000196 E8 [00000000]                   	CALL	_io_store_eflags
   296 0000019B E8 [00000000]                   	CALL	_io_load_eflags
   297 000001A0 5A                              	POP	EDX
   298 000001A1 A9 00040000                     	TEST	EAX,262144
   299 000001A6 74 05                           	JE	L60
   300 000001A8 BE 00000001                     	MOV	ESI,1
   301 000001AD                                 L60:
   302 000001AD 25 FFFBFFFF                     	AND	EAX,-262145
   303 000001B2 50                              	PUSH	EAX
   304 000001B3 E8 [00000000]                   	CALL	_io_store_eflags
   305 000001B8 58                              	POP	EAX
   306 000001B9 89 F0                           	MOV	EAX,ESI
   307 000001BB 84 C0                           	TEST	AL,AL
   308 000001BD 75 31                           	JNE	L63
   309 000001BF                                 L61:
   310 000001BF FF 75 0C                        	PUSH	DWORD [12+EBP]
   311 000001C2 FF 75 08                        	PUSH	DWORD [8+EBP]
   312 000001C5 E8 00000039                     	CALL	_memtest_sub
   313 000001CA 5A                              	POP	EDX
   314 000001CB 89 C3                           	MOV	EBX,EAX
   315 000001CD 59                              	POP	ECX
   316 000001CE 89 F0                           	MOV	EAX,ESI
   317 000001D0 84 C0                           	TEST	AL,AL
   318 000001D2 75 09                           	JNE	L64
   319 000001D4                                 L62:
   320 000001D4 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   321 000001D7 89 D8                           	MOV	EAX,EBX
   322 000001D9 5B                              	POP	EBX
   323 000001DA 5E                              	POP	ESI
   324 000001DB 5D                              	POP	EBP
   325 000001DC C3                              	RET
   326 000001DD                                 L64:
   327 000001DD E8 [00000000]                   	CALL	_load_cr0
   328 000001E2 25 9FFFFFFF                     	AND	EAX,-1610612737
   329 000001E7 50                              	PUSH	EAX
   330 000001E8 E8 [00000000]                   	CALL	_store_cr0
   331 000001ED 58                              	POP	EAX
   332 000001EE EB E4                           	JMP	L62
   333 000001F0                                 L63:
   334 000001F0 E8 [00000000]                   	CALL	_load_cr0
   335 000001F5 0D 60000000                     	OR	EAX,1610612736
   336 000001FA 50                              	PUSH	EAX
   337 000001FB E8 [00000000]                   	CALL	_store_cr0
   338 00000200 5B                              	POP	EBX
   339 00000201 EB BC                           	JMP	L61
   340 00000203                                 	GLOBAL	_memtest_sub
   341 00000203                                 _memtest_sub:
   342 00000203 55                              	PUSH	EBP
   343 00000204 89 E5                           	MOV	EBP,ESP
   344 00000206 8B 55 0C                        	MOV	EDX,DWORD [12+EBP]
   345 00000209 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   346 0000020C 39 D0                           	CMP	EAX,EDX
   347 0000020E 77 09                           	JA	L67
   348 00000210                                 L73:
   349 00000210                                 L71:
   350 00000210 05 00001000                     	ADD	EAX,4096
   351 00000215 39 D0                           	CMP	EAX,EDX
   352 00000217 76 F7                           	JBE	L73
   353 00000219                                 L67:
   354 00000219 5D                              	POP	EBP
   355 0000021A C3                              	RET
   356 0000021B                                 	GLOBAL	_memman_alloc_4k
   357 0000021B                                 _memman_alloc_4k:
   358 0000021B 55                              	PUSH	EBP
   359 0000021C 89 E5                           	MOV	EBP,ESP
   360 0000021E 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   361 00000221 05 00000FFF                     	ADD	EAX,4095
   362 00000226 25 FFFFF000                     	AND	EAX,-4096
   363 0000022B 89 45 0C                        	MOV	DWORD [12+EBP],EAX
   364 0000022E 5D                              	POP	EBP
   365 0000022F E9 FFFFFE0C                     	JMP	_memman_alloc
   366 00000234                                 	GLOBAL	_memman_free_4k
   367 00000234                                 _memman_free_4k:
   368 00000234 55                              	PUSH	EBP
   369 00000235 89 E5                           	MOV	EBP,ESP
   370 00000237 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   371 0000023A 05 00000FFF                     	ADD	EAX,4095
   372 0000023F 25 FFFFF000                     	AND	EAX,-4096
   373 00000244 89 45 10                        	MOV	DWORD [16+EBP],EAX
   374 00000247 5D                              	POP	EBP
   375 00000248 E9 FFFFFE51                     	JMP	_memman_free
