     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_io_load_eflags
     7 00000000                                 	EXTERN	_io_store_eflags
     8 00000000                                 	EXTERN	_load_cr0
     9 00000000                                 	EXTERN	_store_cr0
    10 00000000                                 [FILE "memory.c"]
    11                                          [SECTION .text]
    12 00000000                                 	GLOBAL	_memman_init
    13 00000000                                 _memman_init:
    14 00000000 55                              	PUSH	EBP
    15 00000001 89 E5                           	MOV	EBP,ESP
    16 00000003 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    17 00000006 C7 00 00000000                  	MOV	DWORD [EAX],0
    18 0000000C C7 40 04 00000000               	MOV	DWORD [4+EAX],0
    19 00000013 C7 40 08 00000000               	MOV	DWORD [8+EAX],0
    20 0000001A C7 40 0C 00000000               	MOV	DWORD [12+EAX],0
    21 00000021 5D                              	POP	EBP
    22 00000022 C3                              	RET
    23 00000023                                 	GLOBAL	_memman_total
    24 00000023                                 _memman_total:
    25 00000023 55                              	PUSH	EBP
    26 00000024 31 C0                           	XOR	EAX,EAX
    27 00000026 89 E5                           	MOV	EBP,ESP
    28 00000028 31 D2                           	XOR	EDX,EDX
    29 0000002A 53                              	PUSH	EBX
    30 0000002B 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
    31 0000002E 8B 0B                           	MOV	ECX,DWORD [EBX]
    32 00000030 39 C8                           	CMP	EAX,ECX
    33 00000032 73 09                           	JAE	L9
    34 00000034                                 L7:
    35 00000034 03 44 D3 14                     	ADD	EAX,DWORD [20+EBX+EDX*8]
    36 00000038 42                              	INC	EDX
    37 00000039 39 CA                           	CMP	EDX,ECX
    38 0000003B 72 F7                           	JB	L7
    39 0000003D                                 L9:
    40 0000003D 5B                              	POP	EBX
    41 0000003E 5D                              	POP	EBP
    42 0000003F C3                              	RET
    43 00000040                                 	GLOBAL	_memman_alloc
    44 00000040                                 _memman_alloc:
    45 00000040 55                              	PUSH	EBP
    46 00000041 31 C9                           	XOR	ECX,ECX
    47 00000043 89 E5                           	MOV	EBP,ESP
    48 00000045 57                              	PUSH	EDI
    49 00000046 56                              	PUSH	ESI
    50 00000047 53                              	PUSH	EBX
    51 00000048 8B 75 0C                        	MOV	ESI,DWORD [12+EBP]
    52 0000004B 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
    53 0000004E 8B 03                           	MOV	EAX,DWORD [EBX]
    54 00000050 39 C1                           	CMP	ECX,EAX
    55 00000052 73 0D                           	JAE	L24
    56 00000054                                 L22:
    57 00000054 8B 54 CB 14                     	MOV	EDX,DWORD [20+EBX+ECX*8]
    58 00000058 39 F2                           	CMP	EDX,ESI
    59 0000005A 73 0C                           	JAE	L26
    60 0000005C 41                              	INC	ECX
    61 0000005D 39 C1                           	CMP	ECX,EAX
    62 0000005F 72 F3                           	JB	L22
    63 00000061                                 L24:
    64 00000061 31 C0                           	XOR	EAX,EAX
    65 00000063                                 L10:
    66 00000063 5B                              	POP	EBX
    67 00000064 5E                              	POP	ESI
    68 00000065 5F                              	POP	EDI
    69 00000066 5D                              	POP	EBP
    70 00000067 C3                              	RET
    71 00000068                                 L26:
    72 00000068 8B 7C CB 10                     	MOV	EDI,DWORD [16+EBX+ECX*8]
    73 0000006C 8D 04 3E                        	LEA	EAX,DWORD [ESI+EDI*1]
    74 0000006F 89 44 CB 10                     	MOV	DWORD [16+EBX+ECX*8],EAX
    75 00000073 89 D0                           	MOV	EAX,EDX
    76 00000075 29 F0                           	SUB	EAX,ESI
    77 00000077 89 44 CB 14                     	MOV	DWORD [20+EBX+ECX*8],EAX
    78 0000007B 85 C0                           	TEST	EAX,EAX
    79 0000007D 75 1B                           	JNE	L16
    80 0000007F 8B 33                           	MOV	ESI,DWORD [EBX]
    81 00000081 39 F1                           	CMP	ECX,ESI
    82 00000083 73 15                           	JAE	L16
    83 00000085                                 L21:
    84 00000085 8B 44 CB 18                     	MOV	EAX,DWORD [24+EBX+ECX*8]
    85 00000089 8B 54 CB 1C                     	MOV	EDX,DWORD [28+EBX+ECX*8]
    86 0000008D 89 44 CB 10                     	MOV	DWORD [16+EBX+ECX*8],EAX
    87 00000091 89 54 CB 14                     	MOV	DWORD [20+EBX+ECX*8],EDX
    88 00000095 41                              	INC	ECX
    89 00000096 39 F1                           	CMP	ECX,ESI
    90 00000098 72 EB                           	JB	L21
    91 0000009A                                 L16:
    92 0000009A 89 F8                           	MOV	EAX,EDI
    93 0000009C EB C5                           	JMP	L10
    94 0000009E                                 	GLOBAL	_memman_free
    95 0000009E                                 _memman_free:
    96 0000009E 55                              	PUSH	EBP
    97 0000009F 89 E5                           	MOV	EBP,ESP
    98 000000A1 57                              	PUSH	EDI
    99 000000A2 56                              	PUSH	ESI
   100 000000A3 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   101 000000A6 53                              	PUSH	EBX
   102 000000A7 31 DB                           	XOR	EBX,EBX
   103 000000A9 8B 3E                           	MOV	EDI,DWORD [ESI]
   104 000000AB 39 FB                           	CMP	EBX,EDI
   105 000000AD 7D 0E                           	JGE	L29
   106 000000AF                                 L33:
   107 000000AF 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   108 000000B2 39 44 DE 10                     	CMP	DWORD [16+ESI+EBX*8],EAX
   109 000000B6 77 05                           	JA	L29
   110 000000B8 43                              	INC	EBX
   111 000000B9 39 FB                           	CMP	EBX,EDI
   112 000000BB 7C F2                           	JL	L33
   113 000000BD                                 L29:
   114 000000BD 85 DB                           	TEST	EBX,EBX
   115 000000BF 7E 0F                           	JLE	L34
   116 000000C1 8B 54 DE 0C                     	MOV	EDX,DWORD [12+ESI+EBX*8]
   117 000000C5 8B 44 DE 08                     	MOV	EAX,DWORD [8+ESI+EBX*8]
   118 000000C9 01 D0                           	ADD	EAX,EDX
   119 000000CB 3B 45 0C                        	CMP	EAX,DWORD [12+EBP]
   120 000000CE 74 73                           	JE	L57
   121 000000D0                                 L34:
   122 000000D0 39 FB                           	CMP	EBX,EDI
   123 000000D2 7D 0C                           	JGE	L43
   124 000000D4 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   125 000000D7 03 45 10                        	ADD	EAX,DWORD [16+EBP]
   126 000000DA 3B 44 DE 10                     	CMP	EAX,DWORD [16+ESI+EBX*8]
   127 000000DE 74 53                           	JE	L58
   128 000000E0                                 L43:
   129 000000E0 81 FF 00000FF9                  	CMP	EDI,4089
   130 000000E6 7F 3D                           	JG	L45
   131 000000E8 89 F9                           	MOV	ECX,EDI
   132 000000EA 39 DF                           	CMP	EDI,EBX
   133 000000EC 7E 15                           	JLE	L55
   134 000000EE                                 L50:
   135 000000EE 8B 44 CE 08                     	MOV	EAX,DWORD [8+ESI+ECX*8]
   136 000000F2 8B 54 CE 0C                     	MOV	EDX,DWORD [12+ESI+ECX*8]
   137 000000F6 89 44 CE 10                     	MOV	DWORD [16+ESI+ECX*8],EAX
   138 000000FA 89 54 CE 14                     	MOV	DWORD [20+ESI+ECX*8],EDX
   139 000000FE 49                              	DEC	ECX
   140 000000FF 39 D9                           	CMP	ECX,EBX
   141 00000101 7F EB                           	JG	L50
   142 00000103                                 L55:
   143 00000103 8D 47 01                        	LEA	EAX,DWORD [1+EDI]
   144 00000106 89 06                           	MOV	DWORD [ESI],EAX
   145 00000108 39 46 04                        	CMP	DWORD [4+ESI],EAX
   146 0000010B 7D 03                           	JGE	L51
   147 0000010D 89 46 04                        	MOV	DWORD [4+ESI],EAX
   148 00000110                                 L51:
   149 00000110 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   150 00000113 89 44 DE 10                     	MOV	DWORD [16+ESI+EBX*8],EAX
   151 00000117 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   152 0000011A 89 44 DE 14                     	MOV	DWORD [20+ESI+EBX*8],EAX
   153 0000011E                                 L56:
   154 0000011E 31 C0                           	XOR	EAX,EAX
   155 00000120                                 L27:
   156 00000120 5B                              	POP	EBX
   157 00000121 5E                              	POP	ESI
   158 00000122 5F                              	POP	EDI
   159 00000123 5D                              	POP	EBP
   160 00000124 C3                              	RET
   161 00000125                                 L45:
   162 00000125 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   163 00000128 FF 46 0C                        	INC	DWORD [12+ESI]
   164 0000012B 01 46 08                        	ADD	DWORD [8+ESI],EAX
   165 0000012E 83 C8 FF                        	OR	EAX,-1
   166 00000131 EB ED                           	JMP	L27
   167 00000133                                 L58:
   168 00000133 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   169 00000136 89 44 DE 10                     	MOV	DWORD [16+ESI+EBX*8],EAX
   170 0000013A 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   171 0000013D 01 44 DE 14                     	ADD	DWORD [20+ESI+EBX*8],EAX
   172 00000141 EB DB                           	JMP	L56
   173 00000143                                 L57:
   174 00000143 03 55 10                        	ADD	EDX,DWORD [16+EBP]
   175 00000146 89 54 DE 0C                     	MOV	DWORD [12+ESI+EBX*8],EDX
   176 0000014A 3B 1E                           	CMP	EBX,DWORD [ESI]
   177 0000014C 7D D0                           	JGE	L56
   178 0000014E 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   179 00000151 03 45 10                        	ADD	EAX,DWORD [16+EBP]
   180 00000154 3B 44 DE 10                     	CMP	EAX,DWORD [16+ESI+EBX*8]
   181 00000158 75 C4                           	JNE	L56
   182 0000015A 03 54 DE 14                     	ADD	EDX,DWORD [20+ESI+EBX*8]
   183 0000015E 89 54 DE 0C                     	MOV	DWORD [12+ESI+EBX*8],EDX
   184 00000162 8B 06                           	MOV	EAX,DWORD [ESI]
   185 00000164 48                              	DEC	EAX
   186 00000165 89 06                           	MOV	DWORD [ESI],EAX
   187 00000167 39 C3                           	CMP	EBX,EAX
   188 00000169 7D B3                           	JGE	L56
   189 0000016B 89 C1                           	MOV	ECX,EAX
   190 0000016D                                 L42:
   191 0000016D 8B 44 DE 18                     	MOV	EAX,DWORD [24+ESI+EBX*8]
   192 00000171 8B 54 DE 1C                     	MOV	EDX,DWORD [28+ESI+EBX*8]
   193 00000175 89 44 DE 10                     	MOV	DWORD [16+ESI+EBX*8],EAX
   194 00000179 89 54 DE 14                     	MOV	DWORD [20+ESI+EBX*8],EDX
   195 0000017D 43                              	INC	EBX
   196 0000017E 39 CB                           	CMP	EBX,ECX
   197 00000180 7C EB                           	JL	L42
   198 00000182 EB 9A                           	JMP	L56
   199 00000184                                 	GLOBAL	_memtest
   200 00000184                                 _memtest:
   201 00000184 55                              	PUSH	EBP
   202 00000185 89 E5                           	MOV	EBP,ESP
   203 00000187 56                              	PUSH	ESI
   204 00000188 53                              	PUSH	EBX
   205 00000189 31 F6                           	XOR	ESI,ESI
   206 0000018B E8 [00000000]                   	CALL	_io_load_eflags
   207 00000190 0D 00040000                     	OR	EAX,262144
   208 00000195 50                              	PUSH	EAX
   209 00000196 E8 [00000000]                   	CALL	_io_store_eflags
   210 0000019B E8 [00000000]                   	CALL	_io_load_eflags
   211 000001A0 5A                              	POP	EDX
   212 000001A1 A9 00040000                     	TEST	EAX,262144
   213 000001A6 74 05                           	JE	L60
   214 000001A8 BE 00000001                     	MOV	ESI,1
   215 000001AD                                 L60:
   216 000001AD 25 FFFBFFFF                     	AND	EAX,-262145
   217 000001B2 50                              	PUSH	EAX
   218 000001B3 E8 [00000000]                   	CALL	_io_store_eflags
   219 000001B8 58                              	POP	EAX
   220 000001B9 89 F0                           	MOV	EAX,ESI
   221 000001BB 84 C0                           	TEST	AL,AL
   222 000001BD 75 31                           	JNE	L63
   223 000001BF                                 L61:
   224 000001BF FF 75 0C                        	PUSH	DWORD [12+EBP]
   225 000001C2 FF 75 08                        	PUSH	DWORD [8+EBP]
   226 000001C5 E8 00000039                     	CALL	_memtest_sub
   227 000001CA 5A                              	POP	EDX
   228 000001CB 89 C3                           	MOV	EBX,EAX
   229 000001CD 59                              	POP	ECX
   230 000001CE 89 F0                           	MOV	EAX,ESI
   231 000001D0 84 C0                           	TEST	AL,AL
   232 000001D2 75 09                           	JNE	L64
   233 000001D4                                 L62:
   234 000001D4 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   235 000001D7 89 D8                           	MOV	EAX,EBX
   236 000001D9 5B                              	POP	EBX
   237 000001DA 5E                              	POP	ESI
   238 000001DB 5D                              	POP	EBP
   239 000001DC C3                              	RET
   240 000001DD                                 L64:
   241 000001DD E8 [00000000]                   	CALL	_load_cr0
   242 000001E2 25 9FFFFFFF                     	AND	EAX,-1610612737
   243 000001E7 50                              	PUSH	EAX
   244 000001E8 E8 [00000000]                   	CALL	_store_cr0
   245 000001ED 58                              	POP	EAX
   246 000001EE EB E4                           	JMP	L62
   247 000001F0                                 L63:
   248 000001F0 E8 [00000000]                   	CALL	_load_cr0
   249 000001F5 0D 60000000                     	OR	EAX,1610612736
   250 000001FA 50                              	PUSH	EAX
   251 000001FB E8 [00000000]                   	CALL	_store_cr0
   252 00000200 5B                              	POP	EBX
   253 00000201 EB BC                           	JMP	L61
   254 00000203                                 	GLOBAL	_memtest_sub
   255 00000203                                 _memtest_sub:
   256 00000203 55                              	PUSH	EBP
   257 00000204 89 E5                           	MOV	EBP,ESP
   258 00000206 8B 55 0C                        	MOV	EDX,DWORD [12+EBP]
   259 00000209 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   260 0000020C 39 D0                           	CMP	EAX,EDX
   261 0000020E 77 09                           	JA	L67
   262 00000210                                 L73:
   263 00000210                                 L71:
   264 00000210 05 00001000                     	ADD	EAX,4096
   265 00000215 39 D0                           	CMP	EAX,EDX
   266 00000217 76 F7                           	JBE	L73
   267 00000219                                 L67:
   268 00000219 5D                              	POP	EBP
   269 0000021A C3                              	RET
   270 0000021B                                 	GLOBAL	_memman_alloc_4k
   271 0000021B                                 _memman_alloc_4k:
   272 0000021B 55                              	PUSH	EBP
   273 0000021C 89 E5                           	MOV	EBP,ESP
   274 0000021E 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   275 00000221 05 00000FFF                     	ADD	EAX,4095
   276 00000226 25 FFFFF000                     	AND	EAX,-4096
   277 0000022B 89 45 0C                        	MOV	DWORD [12+EBP],EAX
   278 0000022E 5D                              	POP	EBP
   279 0000022F E9 FFFFFE0C                     	JMP	_memman_alloc
   280 00000234                                 	GLOBAL	_memman_free_4k
   281 00000234                                 _memman_free_4k:
   282 00000234 55                              	PUSH	EBP
   283 00000235 89 E5                           	MOV	EBP,ESP
   284 00000237 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   285 0000023A 05 00000FFF                     	ADD	EAX,4095
   286 0000023F 25 FFFFF000                     	AND	EAX,-4096
   287 00000244 89 45 10                        	MOV	DWORD [16+EBP],EAX
   288 00000247 5D                              	POP	EBP
   289 00000248 E9 FFFFFE51                     	JMP	_memman_free
