     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_memman_alloc_4k
     7 00000000                                 	EXTERN	_memman_free_4k
     8 00000000                                 [FILE "sheet.c"]
     9                                          [SECTION .text]
    10 00000000                                 	GLOBAL	_shtctl_init
    11 00000000                                 _shtctl_init:
    12 00000000 55                              	PUSH	EBP
    13 00000001 89 E5                           	MOV	EBP,ESP
    14 00000003 57                              	PUSH	EDI
    15 00000004 56                              	PUSH	ESI
    16 00000005 53                              	PUSH	EBX
    17 00000006 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
    18 00000009 68 00002814                     	PUSH	10260
    19 0000000E 8B 7D 10                        	MOV	EDI,DWORD [16+EBP]
    20 00000011 56                              	PUSH	ESI
    21 00000012 E8 [00000000]                   	CALL	_memman_alloc_4k
    22 00000017 89 C3                           	MOV	EBX,EAX
    23 00000019 58                              	POP	EAX
    24 0000001A 5A                              	POP	EDX
    25 0000001B 85 DB                           	TEST	EBX,EBX
    26 0000001D 74 4A                           	JE	L3
    27 0000001F 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    28 00000022 0F AF C7                        	IMUL	EAX,EDI
    29 00000025 50                              	PUSH	EAX
    30 00000026 56                              	PUSH	ESI
    31 00000027 E8 [00000000]                   	CALL	_memman_alloc_4k
    32 0000002C 85 C0                           	TEST	EAX,EAX
    33 0000002E 89 43 04                        	MOV	DWORD [4+EBX],EAX
    34 00000031 5A                              	POP	EDX
    35 00000032 59                              	POP	ECX
    36 00000033 74 3E                           	JE	L11
    37 00000035 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    38 00000038 89 7B 08                        	MOV	DWORD [8+EBX],EDI
    39 0000003B 89 03                           	MOV	DWORD [EBX],EAX
    40 0000003D 8D 93 000023DC                  	LEA	EDX,DWORD [9180+EBX]
    41 00000043 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    42 00000046 89 43 0C                        	MOV	DWORD [12+EBX],EAX
    43 00000049 89 D8                           	MOV	EAX,EBX
    44 0000004B C7 43 10 FFFFFFFF               	MOV	DWORD [16+EBX],-1
    45 00000052                                 L9:
    46 00000052 C7 80 00000430 00000000         	MOV	DWORD [1072+EAX],0
    47 0000005C 89 98 00000434                  	MOV	DWORD [1076+EAX],EBX
    48 00000062 83 C0 24                        	ADD	EAX,36
    49 00000065 39 D0                           	CMP	EAX,EDX
    50 00000067 7E E9                           	JLE	L9
    51 00000069                                 L3:
    52 00000069 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
    53 0000006C 89 D8                           	MOV	EAX,EBX
    54 0000006E 5B                              	POP	EBX
    55 0000006F 5E                              	POP	ESI
    56 00000070 5F                              	POP	EDI
    57 00000071 5D                              	POP	EBP
    58 00000072 C3                              	RET
    59 00000073                                 L11:
    60 00000073 68 00002814                     	PUSH	10260
    61 00000078 53                              	PUSH	EBX
    62 00000079 56                              	PUSH	ESI
    63 0000007A E8 [00000000]                   	CALL	_memman_free_4k
    64 0000007F 83 C4 0C                        	ADD	ESP,12
    65 00000082 EB E5                           	JMP	L3
    66 00000084                                 	GLOBAL	_sheet_alloc
    67 00000084                                 _sheet_alloc:
    68 00000084 55                              	PUSH	EBP
    69 00000085 31 D2                           	XOR	EDX,EDX
    70 00000087 89 E5                           	MOV	EBP,ESP
    71 00000089 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    72 0000008C 05 00000414                     	ADD	EAX,1044
    73 00000091                                 L18:
    74 00000091 83 78 1C 00                     	CMP	DWORD [28+EAX],0
    75 00000095 74 10                           	JE	L21
    76 00000097 42                              	INC	EDX
    77 00000098 83 C0 24                        	ADD	EAX,36
    78 0000009B 81 FA 000000FF                  	CMP	EDX,255
    79 000000A1 7E EE                           	JLE	L18
    80 000000A3 31 C0                           	XOR	EAX,EAX
    81 000000A5                                 L12:
    82 000000A5 5D                              	POP	EBP
    83 000000A6 C3                              	RET
    84 000000A7                                 L21:
    85 000000A7 C7 40 1C 00000001               	MOV	DWORD [28+EAX],1
    86 000000AE C7 40 18 FFFFFFFF               	MOV	DWORD [24+EAX],-1
    87 000000B5 EB EE                           	JMP	L12
    88 000000B7                                 	GLOBAL	_sheet_setbuf
    89 000000B7                                 _sheet_setbuf:
    90 000000B7 55                              	PUSH	EBP
    91 000000B8 89 E5                           	MOV	EBP,ESP
    92 000000BA 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    93 000000BD 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    94 000000C0 89 02                           	MOV	DWORD [EDX],EAX
    95 000000C2 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
    96 000000C5 89 42 04                        	MOV	DWORD [4+EDX],EAX
    97 000000C8 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    98 000000CB 89 42 08                        	MOV	DWORD [8+EDX],EAX
    99 000000CE 8B 45 18                        	MOV	EAX,DWORD [24+EBP]
   100 000000D1 89 42 14                        	MOV	DWORD [20+EDX],EAX
   101 000000D4 5D                              	POP	EBP
   102 000000D5 C3                              	RET
   103 000000D6                                 	GLOBAL	_sheet_updown
   104 000000D6                                 _sheet_updown:
   105 000000D6 55                              	PUSH	EBP
   106 000000D7 89 E5                           	MOV	EBP,ESP
   107 000000D9 57                              	PUSH	EDI
   108 000000DA 56                              	PUSH	ESI
   109 000000DB 53                              	PUSH	EBX
   110 000000DC 51                              	PUSH	ECX
   111 000000DD 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   112 000000E0 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
   113 000000E3 8B 77 20                        	MOV	ESI,DWORD [32+EDI]
   114 000000E6 8B 47 18                        	MOV	EAX,DWORD [24+EDI]
   115 000000E9 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   116 000000EC 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   117 000000EF 40                              	INC	EAX
   118 000000F0 39 C3                           	CMP	EBX,EAX
   119 000000F2 7E 02                           	JLE	L24
   120 000000F4 89 C3                           	MOV	EBX,EAX
   121 000000F6                                 L24:
   122 000000F6 83 FB FF                        	CMP	EBX,-1
   123 000000F9 7D 03                           	JGE	L25
   124 000000FB 83 CB FF                        	OR	EBX,-1
   125 000000FE                                 L25:
   126 000000FE 89 5F 18                        	MOV	DWORD [24+EDI],EBX
   127 00000101 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   128 00000104 0F 8E 000000A1                  	JLE	L26
   129 0000010A 85 DB                           	TEST	EBX,EBX
   130 0000010C 78 5C                           	JS	L27
   131 0000010E 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   132 00000111                                 L32:
   133 00000111 8B 44 8E 10                     	MOV	EAX,DWORD [16+ESI+ECX*4]
   134 00000115 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   135 00000119 89 48 18                        	MOV	DWORD [24+EAX],ECX
   136 0000011C 49                              	DEC	ECX
   137 0000011D 39 D9                           	CMP	ECX,EBX
   138 0000011F 7F F0                           	JG	L32
   139 00000121 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   140 00000125 43                              	INC	EBX
   141 00000126 53                              	PUSH	EBX
   142 00000127 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   143 0000012A 89 C8                           	MOV	EAX,ECX
   144 0000012C 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   145 0000012F 50                              	PUSH	EAX
   146 00000130 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   147 00000133 89 D0                           	MOV	EAX,EDX
   148 00000135 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   149 00000138 50                              	PUSH	EAX
   150 00000139 51                              	PUSH	ECX
   151 0000013A 52                              	PUSH	EDX
   152 0000013B 56                              	PUSH	ESI
   153 0000013C E8 00000339                     	CALL	_sheet_refreshmap
   154 00000141 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   155 00000144                                 L62:
   156 00000144 53                              	PUSH	EBX
   157 00000145                                 L61:
   158 00000145 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   159 00000148 89 C8                           	MOV	EAX,ECX
   160 0000014A 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   161 0000014D 50                              	PUSH	EAX
   162 0000014E 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   163 00000151 89 D0                           	MOV	EAX,EDX
   164 00000153 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   165 00000156 50                              	PUSH	EAX
   166 00000157 51                              	PUSH	ECX
   167 00000158 52                              	PUSH	EDX
   168 00000159 56                              	PUSH	ESI
   169 0000015A E8 000000F0                     	CALL	_sheet_refreshsub
   170 0000015F 83 C4 34                        	ADD	ESP,52
   171 00000162                                 L23:
   172 00000162 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   173 00000165 5B                              	POP	EBX
   174 00000166 5E                              	POP	ESI
   175 00000167 5F                              	POP	EDI
   176 00000168 5D                              	POP	EBP
   177 00000169 C3                              	RET
   178 0000016A                                 L27:
   179 0000016A 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   180 0000016D 3B 4E 10                        	CMP	ECX,DWORD [16+ESI]
   181 00000170 7D 11                           	JGE	L56
   182 00000172                                 L38:
   183 00000172 8B 44 8E 18                     	MOV	EAX,DWORD [24+ESI+ECX*4]
   184 00000176 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   185 0000017A 89 48 18                        	MOV	DWORD [24+EAX],ECX
   186 0000017D 41                              	INC	ECX
   187 0000017E 3B 4E 10                        	CMP	ECX,DWORD [16+ESI]
   188 00000181 7C EF                           	JL	L38
   189 00000183                                 L56:
   190 00000183 FF 4E 10                        	DEC	DWORD [16+ESI]
   191 00000186 6A 00                           	PUSH	0
   192 00000188 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   193 0000018B 89 C8                           	MOV	EAX,ECX
   194 0000018D 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   195 00000190 50                              	PUSH	EAX
   196 00000191 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   197 00000194 89 D0                           	MOV	EAX,EDX
   198 00000196 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   199 00000199 50                              	PUSH	EAX
   200 0000019A 51                              	PUSH	ECX
   201 0000019B 52                              	PUSH	EDX
   202 0000019C 56                              	PUSH	ESI
   203 0000019D E8 000002D8                     	CALL	_sheet_refreshmap
   204 000001A2 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   205 000001A5 48                              	DEC	EAX
   206 000001A6 50                              	PUSH	EAX
   207 000001A7 6A 00                           	PUSH	0
   208 000001A9 EB 9A                           	JMP	L61
   209 000001AB                                 L26:
   210 000001AB 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   211 000001AE 7D B2                           	JGE	L23
   212 000001B0 83 7D F0 00                     	CMP	DWORD [-16+EBP],0
   213 000001B4 78 3C                           	JS	L41
   214 000001B6 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   215 000001B9 39 D9                           	CMP	ECX,EBX
   216 000001BB 7D 10                           	JGE	L58
   217 000001BD                                 L46:
   218 000001BD 8B 44 8E 18                     	MOV	EAX,DWORD [24+ESI+ECX*4]
   219 000001C1 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   220 000001C5 89 48 18                        	MOV	DWORD [24+EAX],ECX
   221 000001C8 41                              	INC	ECX
   222 000001C9 39 D9                           	CMP	ECX,EBX
   223 000001CB 7C F0                           	JL	L46
   224 000001CD                                 L58:
   225 000001CD 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   226 000001D1                                 L47:
   227 000001D1 53                              	PUSH	EBX
   228 000001D2 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   229 000001D5 89 C8                           	MOV	EAX,ECX
   230 000001D7 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   231 000001DA 50                              	PUSH	EAX
   232 000001DB 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   233 000001DE 89 D0                           	MOV	EAX,EDX
   234 000001E0 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   235 000001E3 50                              	PUSH	EAX
   236 000001E4 51                              	PUSH	ECX
   237 000001E5 52                              	PUSH	EDX
   238 000001E6 56                              	PUSH	ESI
   239 000001E7 E8 0000028E                     	CALL	_sheet_refreshmap
   240 000001EC 53                              	PUSH	EBX
   241 000001ED E9 FFFFFF52                     	JMP	L62
   242 000001F2                                 L41:
   243 000001F2 8B 4E 10                        	MOV	ECX,DWORD [16+ESI]
   244 000001F5 39 D9                           	CMP	ECX,EBX
   245 000001F7 7C 13                           	JL	L60
   246 000001F9                                 L52:
   247 000001F9 8B 54 8E 14                     	MOV	EDX,DWORD [20+ESI+ECX*4]
   248 000001FD 8D 41 01                        	LEA	EAX,DWORD [1+ECX]
   249 00000200 89 54 8E 18                     	MOV	DWORD [24+ESI+ECX*4],EDX
   250 00000204 49                              	DEC	ECX
   251 00000205 89 42 18                        	MOV	DWORD [24+EDX],EAX
   252 00000208 39 D9                           	CMP	ECX,EBX
   253 0000020A 7D ED                           	JGE	L52
   254 0000020C                                 L60:
   255 0000020C 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   256 00000210 FF 46 10                        	INC	DWORD [16+ESI]
   257 00000213 EB BC                           	JMP	L47
   258 00000215                                 	GLOBAL	_sheet_refresh
   259 00000215                                 _sheet_refresh:
   260 00000215 55                              	PUSH	EBP
   261 00000216 89 E5                           	MOV	EBP,ESP
   262 00000218 53                              	PUSH	EBX
   263 00000219 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   264 0000021C 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   265 0000021F 85 C0                           	TEST	EAX,EAX
   266 00000221 78 27                           	JS	L63
   267 00000223 50                              	PUSH	EAX
   268 00000224 50                              	PUSH	EAX
   269 00000225 8B 4B 10                        	MOV	ECX,DWORD [16+EBX]
   270 00000228 89 C8                           	MOV	EAX,ECX
   271 0000022A 03 4D 10                        	ADD	ECX,DWORD [16+EBP]
   272 0000022D 03 45 18                        	ADD	EAX,DWORD [24+EBP]
   273 00000230 50                              	PUSH	EAX
   274 00000231 8B 53 0C                        	MOV	EDX,DWORD [12+EBX]
   275 00000234 89 D0                           	MOV	EAX,EDX
   276 00000236 03 55 0C                        	ADD	EDX,DWORD [12+EBP]
   277 00000239 03 45 14                        	ADD	EAX,DWORD [20+EBP]
   278 0000023C 50                              	PUSH	EAX
   279 0000023D 51                              	PUSH	ECX
   280 0000023E 52                              	PUSH	EDX
   281 0000023F FF 73 20                        	PUSH	DWORD [32+EBX]
   282 00000242 E8 00000008                     	CALL	_sheet_refreshsub
   283 00000247 83 C4 1C                        	ADD	ESP,28
   284 0000024A                                 L63:
   285 0000024A 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   286 0000024D C9                              	LEAVE
   287 0000024E C3                              	RET
   288 0000024F                                 	GLOBAL	_sheet_refreshsub
   289 0000024F                                 _sheet_refreshsub:
   290 0000024F 55                              	PUSH	EBP
   291 00000250 89 E5                           	MOV	EBP,ESP
   292 00000252 57                              	PUSH	EDI
   293 00000253 56                              	PUSH	ESI
   294 00000254 53                              	PUSH	EBX
   295 00000255 83 EC 2C                        	SUB	ESP,44
   296 00000258 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   297 0000025B 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   298 0000025E 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   299 00000262 8B 00                           	MOV	EAX,DWORD [EAX]
   300 00000264 8B 52 04                        	MOV	EDX,DWORD [4+EDX]
   301 00000267 89 45 DC                        	MOV	DWORD [-36+EBP],EAX
   302 0000026A 89 55 D8                        	MOV	DWORD [-40+EBP],EDX
   303 0000026D 0F 88 00000133                  	JS	L96
   304 00000273                                 L66:
   305 00000273 83 7D 10 00                     	CMP	DWORD [16+EBP],0
   306 00000277 0F 88 0000011D                  	JS	L97
   307 0000027D                                 L67:
   308 0000027D 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   309 00000280 8B 46 08                        	MOV	EAX,DWORD [8+ESI]
   310 00000283 39 45 14                        	CMP	DWORD [20+EBP],EAX
   311 00000286 7E 03                           	JLE	L68
   312 00000288 89 45 14                        	MOV	DWORD [20+EBP],EAX
   313 0000028B                                 L68:
   314 0000028B 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   315 0000028E 8B 47 0C                        	MOV	EAX,DWORD [12+EDI]
   316 00000291 39 45 18                        	CMP	DWORD [24+EBP],EAX
   317 00000294 7E 03                           	JLE	L69
   318 00000296 89 45 18                        	MOV	DWORD [24+EBP],EAX
   319 00000299                                 L69:
   320 00000299 8B 45 1C                        	MOV	EAX,DWORD [28+EBP]
   321 0000029C 8B 55 20                        	MOV	EDX,DWORD [32+EBP]
   322 0000029F 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   323 000002A2 39 D0                           	CMP	EAX,EDX
   324 000002A4 0F 8F 000000BC                  	JG	L91
   325 000002AA                                 L89:
   326 000002AA 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   327 000002AD 8B 75 F0                        	MOV	ESI,DWORD [-16+EBP]
   328 000002B0 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   329 000002B3 8B 5C B7 14                     	MOV	EBX,DWORD [20+EDI+ESI*4]
   330 000002B7 8B 75 14                        	MOV	ESI,DWORD [20+EBP]
   331 000002BA 8B 03                           	MOV	EAX,DWORD [EBX]
   332 000002BC 8B 53 10                        	MOV	EDX,DWORD [16+EBX]
   333 000002BF 89 45 E0                        	MOV	DWORD [-32+EBP],EAX
   334 000002C2 29 D1                           	SUB	ECX,EDX
   335 000002C4 89 D8                           	MOV	EAX,EBX
   336 000002C6 29 F8                           	SUB	EAX,EDI
   337 000002C8 8B 7D 18                        	MOV	EDI,DWORD [24+EBP]
   338 000002CB 2D 00000414                     	SUB	EAX,1044
   339 000002D0 29 D7                           	SUB	EDI,EDX
   340 000002D2 C1 F8 02                        	SAR	EAX,2
   341 000002D5 8B 55 0C                        	MOV	EDX,DWORD [12+EBP]
   342 000002D8 69 C0 38E38E39                  	IMUL	EAX,EAX,954437177
   343 000002DE 88 45 D7                        	MOV	BYTE [-41+EBP],AL
   344 000002E1 89 7D C8                        	MOV	DWORD [-56+EBP],EDI
   345 000002E4 8B 43 0C                        	MOV	EAX,DWORD [12+EBX]
   346 000002E7 29 C6                           	SUB	ESI,EAX
   347 000002E9 29 C2                           	SUB	EDX,EAX
   348 000002EB 89 75 E4                        	MOV	DWORD [-28+EBP],ESI
   349 000002EE 89 55 E8                        	MOV	DWORD [-24+EBP],EDX
   350 000002F1 0F 88 00000097                  	JS	L98
   351 000002F7                                 L74:
   352 000002F7 85 C9                           	TEST	ECX,ECX
   353 000002F9 0F 88 00000088                  	JS	L99
   354 000002FF                                 L75:
   355 000002FF 8B 43 04                        	MOV	EAX,DWORD [4+EBX]
   356 00000302 39 45 E4                        	CMP	DWORD [-28+EBP],EAX
   357 00000305 7E 03                           	JLE	L76
   358 00000307 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   359 0000030A                                 L76:
   360 0000030A 8B 43 08                        	MOV	EAX,DWORD [8+EBX]
   361 0000030D 39 45 C8                        	CMP	DWORD [-56+EBP],EAX
   362 00000310 7E 03                           	JLE	L77
   363 00000312 89 45 C8                        	MOV	DWORD [-56+EBP],EAX
   364 00000315                                 L77:
   365 00000315 89 CE                           	MOV	ESI,ECX
   366 00000317 3B 4D C8                        	CMP	ECX,DWORD [-56+EBP]
   367 0000031A 7D 3B                           	JGE	L93
   368 0000031C                                 L88:
   369 0000031C 8B 7B 10                        	MOV	EDI,DWORD [16+EBX]
   370 0000031F 8B 4D E8                        	MOV	ECX,DWORD [-24+EBP]
   371 00000322 01 F7                           	ADD	EDI,ESI
   372 00000324 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   373 00000327 89 7D EC                        	MOV	DWORD [-20+EBP],EDI
   374 0000032A 7D 25                           	JGE	L95
   375 0000032C                                 L87:
   376 0000032C 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   377 0000032F 8B 7D EC                        	MOV	EDI,DWORD [-20+EBP]
   378 00000332 8B 43 0C                        	MOV	EAX,DWORD [12+EBX]
   379 00000335 0F AF 7A 08                     	IMUL	EDI,DWORD [8+EDX]
   380 00000339 01 C8                           	ADD	EAX,ECX
   381 0000033B 8A 55 D7                        	MOV	DL,BYTE [-41+EBP]
   382 0000033E 01 F8                           	ADD	EAX,EDI
   383 00000340 8B 7D D8                        	MOV	EDI,DWORD [-40+EBP]
   384 00000343 89 45 CC                        	MOV	DWORD [-52+EBP],EAX
   385 00000346 38 14 38                        	CMP	BYTE [EAX+EDI*1],DL
   386 00000349 74 23                           	JE	L100
   387 0000034B                                 L84:
   388 0000034B 41                              	INC	ECX
   389 0000034C 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   390 0000034F 7C DB                           	JL	L87
   391 00000351                                 L95:
   392 00000351 46                              	INC	ESI
   393 00000352 3B 75 C8                        	CMP	ESI,DWORD [-56+EBP]
   394 00000355 7C C5                           	JL	L88
   395 00000357                                 L93:
   396 00000357 8B 75 20                        	MOV	ESI,DWORD [32+EBP]
   397 0000035A FF 45 F0                        	INC	DWORD [-16+EBP]
   398 0000035D 39 75 F0                        	CMP	DWORD [-16+EBP],ESI
   399 00000360 0F 8E FFFFFF44                  	JLE	L89
   400 00000366                                 L91:
   401 00000366 83 C4 2C                        	ADD	ESP,44
   402 00000369 5B                              	POP	EBX
   403 0000036A 5E                              	POP	ESI
   404 0000036B 5F                              	POP	EDI
   405 0000036C 5D                              	POP	EBP
   406 0000036D C3                              	RET
   407 0000036E                                 L100:
   408 0000036E 89 F0                           	MOV	EAX,ESI
   409 00000370 8B 55 E0                        	MOV	EDX,DWORD [-32+EBP]
   410 00000373 0F AF 43 04                     	IMUL	EAX,DWORD [4+EBX]
   411 00000377 01 C8                           	ADD	EAX,ECX
   412 00000379 8B 7D DC                        	MOV	EDI,DWORD [-36+EBP]
   413 0000037C 8A 04 10                        	MOV	AL,BYTE [EAX+EDX*1]
   414 0000037F 8B 55 CC                        	MOV	EDX,DWORD [-52+EBP]
   415 00000382 88 04 3A                        	MOV	BYTE [EDX+EDI*1],AL
   416 00000385 EB C4                           	JMP	L84
   417 00000387                                 L99:
   418 00000387 31 C9                           	XOR	ECX,ECX
   419 00000389 E9 FFFFFF71                     	JMP	L75
   420 0000038E                                 L98:
   421 0000038E C7 45 E8 00000000               	MOV	DWORD [-24+EBP],0
   422 00000395 E9 FFFFFF5D                     	JMP	L74
   423 0000039A                                 L97:
   424 0000039A C7 45 10 00000000               	MOV	DWORD [16+EBP],0
   425 000003A1 E9 FFFFFED7                     	JMP	L67
   426 000003A6                                 L96:
   427 000003A6 C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   428 000003AD E9 FFFFFEC1                     	JMP	L66
   429 000003B2                                 	GLOBAL	_sheet_slide
   430 000003B2                                 _sheet_slide:
   431 000003B2 55                              	PUSH	EBP
   432 000003B3 89 E5                           	MOV	EBP,ESP
   433 000003B5 57                              	PUSH	EDI
   434 000003B6 56                              	PUSH	ESI
   435 000003B7 53                              	PUSH	EBX
   436 000003B8 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   437 000003BB 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   438 000003BE 8B 7B 0C                        	MOV	EDI,DWORD [12+EBX]
   439 000003C1 8B 73 10                        	MOV	ESI,DWORD [16+EBX]
   440 000003C4 89 43 0C                        	MOV	DWORD [12+EBX],EAX
   441 000003C7 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   442 000003CA 89 43 10                        	MOV	DWORD [16+EBX],EAX
   443 000003CD 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   444 000003D1 78 7C                           	JS	L101
   445 000003D3 6A 00                           	PUSH	0
   446 000003D5 89 F0                           	MOV	EAX,ESI
   447 000003D7 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   448 000003DA 50                              	PUSH	EAX
   449 000003DB 89 F8                           	MOV	EAX,EDI
   450 000003DD 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   451 000003E0 50                              	PUSH	EAX
   452 000003E1 56                              	PUSH	ESI
   453 000003E2 57                              	PUSH	EDI
   454 000003E3 FF 73 20                        	PUSH	DWORD [32+EBX]
   455 000003E6 E8 0000008F                     	CALL	_sheet_refreshmap
   456 000003EB 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   457 000003EE FF 73 18                        	PUSH	DWORD [24+EBX]
   458 000003F1 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   459 000003F4 50                              	PUSH	EAX
   460 000003F5 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   461 000003F8 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   462 000003FB 50                              	PUSH	EAX
   463 000003FC FF 75 10                        	PUSH	DWORD [16+EBP]
   464 000003FF FF 75 0C                        	PUSH	DWORD [12+EBP]
   465 00000402 FF 73 20                        	PUSH	DWORD [32+EBX]
   466 00000405 E8 00000070                     	CALL	_sheet_refreshmap
   467 0000040A 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   468 0000040D 83 C4 30                        	ADD	ESP,48
   469 00000410 48                              	DEC	EAX
   470 00000411 50                              	PUSH	EAX
   471 00000412 89 F0                           	MOV	EAX,ESI
   472 00000414 6A 00                           	PUSH	0
   473 00000416 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   474 00000419 50                              	PUSH	EAX
   475 0000041A 89 F8                           	MOV	EAX,EDI
   476 0000041C 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   477 0000041F 50                              	PUSH	EAX
   478 00000420 56                              	PUSH	ESI
   479 00000421 57                              	PUSH	EDI
   480 00000422 FF 73 20                        	PUSH	DWORD [32+EBX]
   481 00000425 E8 FFFFFE25                     	CALL	_sheet_refreshsub
   482 0000042A 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   483 0000042D FF 73 18                        	PUSH	DWORD [24+EBX]
   484 00000430 FF 73 18                        	PUSH	DWORD [24+EBX]
   485 00000433 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   486 00000436 50                              	PUSH	EAX
   487 00000437 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   488 0000043A 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   489 0000043D 50                              	PUSH	EAX
   490 0000043E FF 75 10                        	PUSH	DWORD [16+EBP]
   491 00000441 FF 75 0C                        	PUSH	DWORD [12+EBP]
   492 00000444 FF 73 20                        	PUSH	DWORD [32+EBX]
   493 00000447 E8 FFFFFE03                     	CALL	_sheet_refreshsub
   494 0000044C 83 C4 38                        	ADD	ESP,56
   495 0000044F                                 L101:
   496 0000044F 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   497 00000452 5B                              	POP	EBX
   498 00000453 5E                              	POP	ESI
   499 00000454 5F                              	POP	EDI
   500 00000455 5D                              	POP	EBP
   501 00000456 C3                              	RET
   502 00000457                                 	GLOBAL	_sheet_free
   503 00000457                                 _sheet_free:
   504 00000457 55                              	PUSH	EBP
   505 00000458 89 E5                           	MOV	EBP,ESP
   506 0000045A 53                              	PUSH	EBX
   507 0000045B 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   508 0000045E 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   509 00000462 78 0A                           	JS	L104
   510 00000464 6A FF                           	PUSH	-1
   511 00000466 53                              	PUSH	EBX
   512 00000467 E8 FFFFFC6A                     	CALL	_sheet_updown
   513 0000046C 58                              	POP	EAX
   514 0000046D 5A                              	POP	EDX
   515 0000046E                                 L104:
   516 0000046E C7 43 1C 00000000               	MOV	DWORD [28+EBX],0
   517 00000475 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   518 00000478 C9                              	LEAVE
   519 00000479 C3                              	RET
   520 0000047A                                 	GLOBAL	_sheet_refreshmap
   521 0000047A                                 _sheet_refreshmap:
   522 0000047A 55                              	PUSH	EBP
   523 0000047B 89 E5                           	MOV	EBP,ESP
   524 0000047D 57                              	PUSH	EDI
   525 0000047E 56                              	PUSH	ESI
   526 0000047F 53                              	PUSH	EBX
   527 00000480 83 EC 28                        	SUB	ESP,40
   528 00000483 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   529 00000486 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   530 0000048A 8B 40 04                        	MOV	EAX,DWORD [4+EAX]
   531 0000048D 89 45 D8                        	MOV	DWORD [-40+EBP],EAX
   532 00000490 0F 88 00000135                  	JS	L136
   533 00000496                                 L106:
   534 00000496 83 7D 10 00                     	CMP	DWORD [16+EBP],0
   535 0000049A 0F 88 0000011F                  	JS	L137
   536 000004A0                                 L107:
   537 000004A0 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   538 000004A3 8B 42 08                        	MOV	EAX,DWORD [8+EDX]
   539 000004A6 39 45 14                        	CMP	DWORD [20+EBP],EAX
   540 000004A9 7E 03                           	JLE	L108
   541 000004AB 89 45 14                        	MOV	DWORD [20+EBP],EAX
   542 000004AE                                 L108:
   543 000004AE 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   544 000004B1 8B 46 0C                        	MOV	EAX,DWORD [12+ESI]
   545 000004B4 39 45 18                        	CMP	DWORD [24+EBP],EAX
   546 000004B7 7E 03                           	JLE	L109
   547 000004B9 89 45 18                        	MOV	DWORD [24+EBP],EAX
   548 000004BC                                 L109:
   549 000004BC 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   550 000004BF 8B 7D 1C                        	MOV	EDI,DWORD [28+EBP]
   551 000004C2 89 7D F0                        	MOV	DWORD [-16+EBP],EDI
   552 000004C5 3B 78 10                        	CMP	EDI,DWORD [16+EAX]
   553 000004C8 0F 8F 000000D6                  	JG	L131
   554 000004CE                                 L129:
   555 000004CE 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   556 000004D1 8B 55 F0                        	MOV	EDX,DWORD [-16+EBP]
   557 000004D4 8B 5D 10                        	MOV	EBX,DWORD [16+EBP]
   558 000004D7 8B 4C 96 14                     	MOV	ECX,DWORD [20+ESI+EDX*4]
   559 000004DB 89 C8                           	MOV	EAX,ECX
   560 000004DD 29 F0                           	SUB	EAX,ESI
   561 000004DF 8B 39                           	MOV	EDI,DWORD [ECX]
   562 000004E1 2D 00000414                     	SUB	EAX,1044
   563 000004E6 8B 51 10                        	MOV	EDX,DWORD [16+ECX]
   564 000004E9 C1 F8 02                        	SAR	EAX,2
   565 000004EC 89 7D E0                        	MOV	DWORD [-32+EBP],EDI
   566 000004EF 69 C0 38E38E39                  	IMUL	EAX,EAX,954437177
   567 000004F5 8B 7D 18                        	MOV	EDI,DWORD [24+EBP]
   568 000004F8 29 D3                           	SUB	EBX,EDX
   569 000004FA 29 D7                           	SUB	EDI,EDX
   570 000004FC 88 45 DF                        	MOV	BYTE [-33+EBP],AL
   571 000004FF 8B 75 14                        	MOV	ESI,DWORD [20+EBP]
   572 00000502 8B 55 0C                        	MOV	EDX,DWORD [12+EBP]
   573 00000505 8B 41 0C                        	MOV	EAX,DWORD [12+ECX]
   574 00000508 89 7D D4                        	MOV	DWORD [-44+EBP],EDI
   575 0000050B 29 C6                           	SUB	ESI,EAX
   576 0000050D 29 C2                           	SUB	EDX,EAX
   577 0000050F 89 75 CC                        	MOV	DWORD [-52+EBP],ESI
   578 00000512 89 55 E4                        	MOV	DWORD [-28+EBP],EDX
   579 00000515 0F 88 00000098                  	JS	L138
   580 0000051B                                 L114:
   581 0000051B 85 DB                           	TEST	EBX,EBX
   582 0000051D 0F 88 00000089                  	JS	L139
   583 00000523                                 L115:
   584 00000523 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   585 00000526 39 45 CC                        	CMP	DWORD [-52+EBP],EAX
   586 00000529 7E 03                           	JLE	L116
   587 0000052B 89 45 CC                        	MOV	DWORD [-52+EBP],EAX
   588 0000052E                                 L116:
   589 0000052E 8B 41 08                        	MOV	EAX,DWORD [8+ECX]
   590 00000531 39 45 D4                        	CMP	DWORD [-44+EBP],EAX
   591 00000534 7E 03                           	JLE	L117
   592 00000536 89 45 D4                        	MOV	DWORD [-44+EBP],EAX
   593 00000539                                 L117:
   594 00000539 3B 5D D4                        	CMP	EBX,DWORD [-44+EBP]
   595 0000053C 7D 54                           	JGE	L133
   596 0000053E                                 L128:
   597 0000053E 8B 71 10                        	MOV	ESI,DWORD [16+ECX]
   598 00000541 8B 55 E4                        	MOV	EDX,DWORD [-28+EBP]
   599 00000544 01 DE                           	ADD	ESI,EBX
   600 00000546 3B 55 CC                        	CMP	EDX,DWORD [-52+EBP]
   601 00000549 89 75 E8                        	MOV	DWORD [-24+EBP],ESI
   602 0000054C 7D 3E                           	JGE	L135
   603 0000054E                                 L127:
   604 0000054E 89 D8                           	MOV	EAX,EBX
   605 00000550 8B 79 0C                        	MOV	EDI,DWORD [12+ECX]
   606 00000553 0F AF 41 04                     	IMUL	EAX,DWORD [4+ECX]
   607 00000557 01 D7                           	ADD	EDI,EDX
   608 00000559 8B 75 E0                        	MOV	ESI,DWORD [-32+EBP]
   609 0000055C 01 D0                           	ADD	EAX,EDX
   610 0000055E 89 7D EC                        	MOV	DWORD [-20+EBP],EDI
   611 00000561 0F B6 34 30                     	MOVZX	ESI,BYTE [EAX+ESI*1]
   612 00000565 3B 71 14                        	CMP	ESI,DWORD [20+ECX]
   613 00000568 74 1C                           	JE	L124
   614 0000056A 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   615 0000056D 8B 45 E8                        	MOV	EAX,DWORD [-24+EBP]
   616 00000570 8B 75 D8                        	MOV	ESI,DWORD [-40+EBP]
   617 00000573 0F AF 47 08                     	IMUL	EAX,DWORD [8+EDI]
   618 00000577 03 45 EC                        	ADD	EAX,DWORD [-20+EBP]
   619 0000057A 89 45 D0                        	MOV	DWORD [-48+EBP],EAX
   620 0000057D 8A 45 DF                        	MOV	AL,BYTE [-33+EBP]
   621 00000580 8B 7D D0                        	MOV	EDI,DWORD [-48+EBP]
   622 00000583 88 04 37                        	MOV	BYTE [EDI+ESI*1],AL
   623 00000586                                 L124:
   624 00000586 42                              	INC	EDX
   625 00000587 3B 55 CC                        	CMP	EDX,DWORD [-52+EBP]
   626 0000058A 7C C2                           	JL	L127
   627 0000058C                                 L135:
   628 0000058C 43                              	INC	EBX
   629 0000058D 3B 5D D4                        	CMP	EBX,DWORD [-44+EBP]
   630 00000590 7C AC                           	JL	L128
   631 00000592                                 L133:
   632 00000592 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   633 00000595 FF 45 F0                        	INC	DWORD [-16+EBP]
   634 00000598 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   635 0000059B 3B 42 10                        	CMP	EAX,DWORD [16+EDX]
   636 0000059E 0F 8E FFFFFF2A                  	JLE	L129
   637 000005A4                                 L131:
   638 000005A4 83 C4 28                        	ADD	ESP,40
   639 000005A7 5B                              	POP	EBX
   640 000005A8 5E                              	POP	ESI
   641 000005A9 5F                              	POP	EDI
   642 000005AA 5D                              	POP	EBP
   643 000005AB C3                              	RET
   644 000005AC                                 L139:
   645 000005AC 31 DB                           	XOR	EBX,EBX
   646 000005AE E9 FFFFFF70                     	JMP	L115
   647 000005B3                                 L138:
   648 000005B3 C7 45 E4 00000000               	MOV	DWORD [-28+EBP],0
   649 000005BA E9 FFFFFF5C                     	JMP	L114
   650 000005BF                                 L137:
   651 000005BF C7 45 10 00000000               	MOV	DWORD [16+EBP],0
   652 000005C6 E9 FFFFFED5                     	JMP	L107
   653 000005CB                                 L136:
   654 000005CB C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   655 000005D2 E9 FFFFFEBF                     	JMP	L106
