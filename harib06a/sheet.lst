     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_memman_alloc_4k
     7 00000000                                 	EXTERN	_memman_free_4k
     8 00000000                                 [FILE "sheet.c"]
     9                                          [SECTION .data]
    10 00000000                                 _keytable:
    11 00000000 00                              	DB	0
    12 00000001 00                              	DB	0
    13 00000002 31                              	DB	49
    14 00000003 32                              	DB	50
    15 00000004 33                              	DB	51
    16 00000005 34                              	DB	52
    17 00000006 35                              	DB	53
    18 00000007 36                              	DB	54
    19 00000008 37                              	DB	55
    20 00000009 38                              	DB	56
    21 0000000A 39                              	DB	57
    22 0000000B 30                              	DB	48
    23 0000000C 2D                              	DB	45
    24 0000000D 5E                              	DB	94
    25 0000000E 00                              	DB	0
    26 0000000F 00                              	DB	0
    27 00000010 51                              	DB	81
    28 00000011 57                              	DB	87
    29 00000012 45                              	DB	69
    30 00000013 52                              	DB	82
    31 00000014 54                              	DB	84
    32 00000015 59                              	DB	89
    33 00000016 55                              	DB	85
    34 00000017 49                              	DB	73
    35 00000018 4F                              	DB	79
    36 00000019 50                              	DB	80
    37 0000001A 40                              	DB	64
    38 0000001B 5B                              	DB	91
    39 0000001C 00                              	DB	0
    40 0000001D 00                              	DB	0
    41 0000001E 41                              	DB	65
    42 0000001F 53                              	DB	83
    43 00000020 44                              	DB	68
    44 00000021 46                              	DB	70
    45 00000022 47                              	DB	71
    46 00000023 48                              	DB	72
    47 00000024 4A                              	DB	74
    48 00000025 4B                              	DB	75
    49 00000026 4C                              	DB	76
    50 00000027 3B                              	DB	59
    51 00000028 3A                              	DB	58
    52 00000029 00                              	DB	0
    53 0000002A 00                              	DB	0
    54 0000002B 5D                              	DB	93
    55 0000002C 5A                              	DB	90
    56 0000002D 58                              	DB	88
    57 0000002E 43                              	DB	67
    58 0000002F 56                              	DB	86
    59 00000030 42                              	DB	66
    60 00000031 4E                              	DB	78
    61 00000032 4D                              	DB	77
    62 00000033 2C                              	DB	44
    63 00000034 2E                              	DB	46
    64 00000035 2F                              	DB	47
    65 00000036 00                              	DB	0
    66 00000037 2A                              	DB	42
    67 00000038 00                              	DB	0
    68 00000039 20                              	DB	32
    69 0000003A 00                              	DB	0
    70 0000003B 00                              	DB	0
    71 0000003C 00                              	DB	0
    72 0000003D 00                              	DB	0
    73 0000003E 00                              	DB	0
    74 0000003F 00                              	DB	0
    75 00000040 00                              	DB	0
    76 00000041 00                              	DB	0
    77 00000042 00                              	DB	0
    78 00000043 00                              	DB	0
    79 00000044 00                              	DB	0
    80 00000045 00                              	DB	0
    81 00000046 00                              	DB	0
    82 00000047 37                              	DB	55
    83 00000048 38                              	DB	56
    84 00000049 39                              	DB	57
    85 0000004A 2D                              	DB	45
    86 0000004B 34                              	DB	52
    87 0000004C 35                              	DB	53
    88 0000004D 36                              	DB	54
    89 0000004E 2B                              	DB	43
    90 0000004F 31                              	DB	49
    91 00000050 32                              	DB	50
    92 00000051 33                              	DB	51
    93 00000052 30                              	DB	48
    94 00000053 2E                              	DB	46
    95                                          [SECTION .text]
    96 00000000                                 	GLOBAL	_shtctl_init
    97 00000000                                 _shtctl_init:
    98 00000000 55                              	PUSH	EBP
    99 00000001 89 E5                           	MOV	EBP,ESP
   100 00000003 57                              	PUSH	EDI
   101 00000004 56                              	PUSH	ESI
   102 00000005 53                              	PUSH	EBX
   103 00000006 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   104 00000009 68 00002814                     	PUSH	10260
   105 0000000E 8B 7D 10                        	MOV	EDI,DWORD [16+EBP]
   106 00000011 56                              	PUSH	ESI
   107 00000012 E8 [00000000]                   	CALL	_memman_alloc_4k
   108 00000017 89 C3                           	MOV	EBX,EAX
   109 00000019 58                              	POP	EAX
   110 0000001A 5A                              	POP	EDX
   111 0000001B 85 DB                           	TEST	EBX,EBX
   112 0000001D 74 4A                           	JE	L3
   113 0000001F 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   114 00000022 0F AF C7                        	IMUL	EAX,EDI
   115 00000025 50                              	PUSH	EAX
   116 00000026 56                              	PUSH	ESI
   117 00000027 E8 [00000000]                   	CALL	_memman_alloc_4k
   118 0000002C 85 C0                           	TEST	EAX,EAX
   119 0000002E 89 43 04                        	MOV	DWORD [4+EBX],EAX
   120 00000031 5A                              	POP	EDX
   121 00000032 59                              	POP	ECX
   122 00000033 74 3E                           	JE	L11
   123 00000035 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   124 00000038 89 7B 08                        	MOV	DWORD [8+EBX],EDI
   125 0000003B 89 03                           	MOV	DWORD [EBX],EAX
   126 0000003D 8D 93 000023DC                  	LEA	EDX,DWORD [9180+EBX]
   127 00000043 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   128 00000046 89 43 0C                        	MOV	DWORD [12+EBX],EAX
   129 00000049 89 D8                           	MOV	EAX,EBX
   130 0000004B C7 43 10 FFFFFFFF               	MOV	DWORD [16+EBX],-1
   131 00000052                                 L9:
   132 00000052 C7 80 00000430 00000000         	MOV	DWORD [1072+EAX],0
   133 0000005C 89 98 00000434                  	MOV	DWORD [1076+EAX],EBX
   134 00000062 83 C0 24                        	ADD	EAX,36
   135 00000065 39 D0                           	CMP	EAX,EDX
   136 00000067 7E E9                           	JLE	L9
   137 00000069                                 L3:
   138 00000069 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   139 0000006C 89 D8                           	MOV	EAX,EBX
   140 0000006E 5B                              	POP	EBX
   141 0000006F 5E                              	POP	ESI
   142 00000070 5F                              	POP	EDI
   143 00000071 5D                              	POP	EBP
   144 00000072 C3                              	RET
   145 00000073                                 L11:
   146 00000073 68 00002814                     	PUSH	10260
   147 00000078 53                              	PUSH	EBX
   148 00000079 56                              	PUSH	ESI
   149 0000007A E8 [00000000]                   	CALL	_memman_free_4k
   150 0000007F 83 C4 0C                        	ADD	ESP,12
   151 00000082 EB E5                           	JMP	L3
   152 00000084                                 	GLOBAL	_sheet_alloc
   153 00000084                                 _sheet_alloc:
   154 00000084 55                              	PUSH	EBP
   155 00000085 31 D2                           	XOR	EDX,EDX
   156 00000087 89 E5                           	MOV	EBP,ESP
   157 00000089 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   158 0000008C 05 00000414                     	ADD	EAX,1044
   159 00000091                                 L18:
   160 00000091 83 78 1C 00                     	CMP	DWORD [28+EAX],0
   161 00000095 74 10                           	JE	L21
   162 00000097 42                              	INC	EDX
   163 00000098 83 C0 24                        	ADD	EAX,36
   164 0000009B 81 FA 000000FF                  	CMP	EDX,255
   165 000000A1 7E EE                           	JLE	L18
   166 000000A3 31 C0                           	XOR	EAX,EAX
   167 000000A5                                 L12:
   168 000000A5 5D                              	POP	EBP
   169 000000A6 C3                              	RET
   170 000000A7                                 L21:
   171 000000A7 C7 40 1C 00000001               	MOV	DWORD [28+EAX],1
   172 000000AE C7 40 18 FFFFFFFF               	MOV	DWORD [24+EAX],-1
   173 000000B5 EB EE                           	JMP	L12
   174 000000B7                                 	GLOBAL	_sheet_setbuf
   175 000000B7                                 _sheet_setbuf:
   176 000000B7 55                              	PUSH	EBP
   177 000000B8 89 E5                           	MOV	EBP,ESP
   178 000000BA 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   179 000000BD 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   180 000000C0 89 02                           	MOV	DWORD [EDX],EAX
   181 000000C2 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   182 000000C5 89 42 04                        	MOV	DWORD [4+EDX],EAX
   183 000000C8 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   184 000000CB 89 42 08                        	MOV	DWORD [8+EDX],EAX
   185 000000CE 8B 45 18                        	MOV	EAX,DWORD [24+EBP]
   186 000000D1 89 42 14                        	MOV	DWORD [20+EDX],EAX
   187 000000D4 5D                              	POP	EBP
   188 000000D5 C3                              	RET
   189 000000D6                                 	GLOBAL	_sheet_updown
   190 000000D6                                 _sheet_updown:
   191 000000D6 55                              	PUSH	EBP
   192 000000D7 89 E5                           	MOV	EBP,ESP
   193 000000D9 57                              	PUSH	EDI
   194 000000DA 56                              	PUSH	ESI
   195 000000DB 53                              	PUSH	EBX
   196 000000DC 51                              	PUSH	ECX
   197 000000DD 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   198 000000E0 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
   199 000000E3 8B 77 20                        	MOV	ESI,DWORD [32+EDI]
   200 000000E6 8B 47 18                        	MOV	EAX,DWORD [24+EDI]
   201 000000E9 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   202 000000EC 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   203 000000EF 40                              	INC	EAX
   204 000000F0 39 C3                           	CMP	EBX,EAX
   205 000000F2 7E 02                           	JLE	L24
   206 000000F4 89 C3                           	MOV	EBX,EAX
   207 000000F6                                 L24:
   208 000000F6 83 FB FF                        	CMP	EBX,-1
   209 000000F9 7D 03                           	JGE	L25
   210 000000FB 83 CB FF                        	OR	EBX,-1
   211 000000FE                                 L25:
   212 000000FE 89 5F 18                        	MOV	DWORD [24+EDI],EBX
   213 00000101 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   214 00000104 0F 8E 000000A1                  	JLE	L26
   215 0000010A 85 DB                           	TEST	EBX,EBX
   216 0000010C 78 5C                           	JS	L27
   217 0000010E 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   218 00000111                                 L32:
   219 00000111 8B 44 8E 10                     	MOV	EAX,DWORD [16+ESI+ECX*4]
   220 00000115 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   221 00000119 89 48 18                        	MOV	DWORD [24+EAX],ECX
   222 0000011C 49                              	DEC	ECX
   223 0000011D 39 D9                           	CMP	ECX,EBX
   224 0000011F 7F F0                           	JG	L32
   225 00000121 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   226 00000125 43                              	INC	EBX
   227 00000126 53                              	PUSH	EBX
   228 00000127 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   229 0000012A 89 C8                           	MOV	EAX,ECX
   230 0000012C 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   231 0000012F 50                              	PUSH	EAX
   232 00000130 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   233 00000133 89 D0                           	MOV	EAX,EDX
   234 00000135 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   235 00000138 50                              	PUSH	EAX
   236 00000139 51                              	PUSH	ECX
   237 0000013A 52                              	PUSH	EDX
   238 0000013B 56                              	PUSH	ESI
   239 0000013C E8 00000339                     	CALL	_sheet_refreshmap
   240 00000141 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   241 00000144                                 L62:
   242 00000144 53                              	PUSH	EBX
   243 00000145                                 L61:
   244 00000145 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   245 00000148 89 C8                           	MOV	EAX,ECX
   246 0000014A 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   247 0000014D 50                              	PUSH	EAX
   248 0000014E 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   249 00000151 89 D0                           	MOV	EAX,EDX
   250 00000153 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   251 00000156 50                              	PUSH	EAX
   252 00000157 51                              	PUSH	ECX
   253 00000158 52                              	PUSH	EDX
   254 00000159 56                              	PUSH	ESI
   255 0000015A E8 000000F0                     	CALL	_sheet_refreshsub
   256 0000015F 83 C4 34                        	ADD	ESP,52
   257 00000162                                 L23:
   258 00000162 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   259 00000165 5B                              	POP	EBX
   260 00000166 5E                              	POP	ESI
   261 00000167 5F                              	POP	EDI
   262 00000168 5D                              	POP	EBP
   263 00000169 C3                              	RET
   264 0000016A                                 L27:
   265 0000016A 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   266 0000016D 3B 4E 10                        	CMP	ECX,DWORD [16+ESI]
   267 00000170 7D 11                           	JGE	L56
   268 00000172                                 L38:
   269 00000172 8B 44 8E 18                     	MOV	EAX,DWORD [24+ESI+ECX*4]
   270 00000176 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   271 0000017A 89 48 18                        	MOV	DWORD [24+EAX],ECX
   272 0000017D 41                              	INC	ECX
   273 0000017E 3B 4E 10                        	CMP	ECX,DWORD [16+ESI]
   274 00000181 7C EF                           	JL	L38
   275 00000183                                 L56:
   276 00000183 FF 4E 10                        	DEC	DWORD [16+ESI]
   277 00000186 6A 00                           	PUSH	0
   278 00000188 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   279 0000018B 89 C8                           	MOV	EAX,ECX
   280 0000018D 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   281 00000190 50                              	PUSH	EAX
   282 00000191 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   283 00000194 89 D0                           	MOV	EAX,EDX
   284 00000196 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   285 00000199 50                              	PUSH	EAX
   286 0000019A 51                              	PUSH	ECX
   287 0000019B 52                              	PUSH	EDX
   288 0000019C 56                              	PUSH	ESI
   289 0000019D E8 000002D8                     	CALL	_sheet_refreshmap
   290 000001A2 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   291 000001A5 48                              	DEC	EAX
   292 000001A6 50                              	PUSH	EAX
   293 000001A7 6A 00                           	PUSH	0
   294 000001A9 EB 9A                           	JMP	L61
   295 000001AB                                 L26:
   296 000001AB 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   297 000001AE 7D B2                           	JGE	L23
   298 000001B0 83 7D F0 00                     	CMP	DWORD [-16+EBP],0
   299 000001B4 78 3C                           	JS	L41
   300 000001B6 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   301 000001B9 39 D9                           	CMP	ECX,EBX
   302 000001BB 7D 10                           	JGE	L58
   303 000001BD                                 L46:
   304 000001BD 8B 44 8E 18                     	MOV	EAX,DWORD [24+ESI+ECX*4]
   305 000001C1 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   306 000001C5 89 48 18                        	MOV	DWORD [24+EAX],ECX
   307 000001C8 41                              	INC	ECX
   308 000001C9 39 D9                           	CMP	ECX,EBX
   309 000001CB 7C F0                           	JL	L46
   310 000001CD                                 L58:
   311 000001CD 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   312 000001D1                                 L47:
   313 000001D1 53                              	PUSH	EBX
   314 000001D2 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   315 000001D5 89 C8                           	MOV	EAX,ECX
   316 000001D7 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   317 000001DA 50                              	PUSH	EAX
   318 000001DB 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   319 000001DE 89 D0                           	MOV	EAX,EDX
   320 000001E0 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   321 000001E3 50                              	PUSH	EAX
   322 000001E4 51                              	PUSH	ECX
   323 000001E5 52                              	PUSH	EDX
   324 000001E6 56                              	PUSH	ESI
   325 000001E7 E8 0000028E                     	CALL	_sheet_refreshmap
   326 000001EC 53                              	PUSH	EBX
   327 000001ED E9 FFFFFF52                     	JMP	L62
   328 000001F2                                 L41:
   329 000001F2 8B 4E 10                        	MOV	ECX,DWORD [16+ESI]
   330 000001F5 39 D9                           	CMP	ECX,EBX
   331 000001F7 7C 13                           	JL	L60
   332 000001F9                                 L52:
   333 000001F9 8B 54 8E 14                     	MOV	EDX,DWORD [20+ESI+ECX*4]
   334 000001FD 8D 41 01                        	LEA	EAX,DWORD [1+ECX]
   335 00000200 89 54 8E 18                     	MOV	DWORD [24+ESI+ECX*4],EDX
   336 00000204 49                              	DEC	ECX
   337 00000205 89 42 18                        	MOV	DWORD [24+EDX],EAX
   338 00000208 39 D9                           	CMP	ECX,EBX
   339 0000020A 7D ED                           	JGE	L52
   340 0000020C                                 L60:
   341 0000020C 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   342 00000210 FF 46 10                        	INC	DWORD [16+ESI]
   343 00000213 EB BC                           	JMP	L47
   344 00000215                                 	GLOBAL	_sheet_refresh
   345 00000215                                 _sheet_refresh:
   346 00000215 55                              	PUSH	EBP
   347 00000216 89 E5                           	MOV	EBP,ESP
   348 00000218 53                              	PUSH	EBX
   349 00000219 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   350 0000021C 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   351 0000021F 85 C0                           	TEST	EAX,EAX
   352 00000221 78 27                           	JS	L63
   353 00000223 50                              	PUSH	EAX
   354 00000224 50                              	PUSH	EAX
   355 00000225 8B 4B 10                        	MOV	ECX,DWORD [16+EBX]
   356 00000228 89 C8                           	MOV	EAX,ECX
   357 0000022A 03 4D 10                        	ADD	ECX,DWORD [16+EBP]
   358 0000022D 03 45 18                        	ADD	EAX,DWORD [24+EBP]
   359 00000230 50                              	PUSH	EAX
   360 00000231 8B 53 0C                        	MOV	EDX,DWORD [12+EBX]
   361 00000234 89 D0                           	MOV	EAX,EDX
   362 00000236 03 55 0C                        	ADD	EDX,DWORD [12+EBP]
   363 00000239 03 45 14                        	ADD	EAX,DWORD [20+EBP]
   364 0000023C 50                              	PUSH	EAX
   365 0000023D 51                              	PUSH	ECX
   366 0000023E 52                              	PUSH	EDX
   367 0000023F FF 73 20                        	PUSH	DWORD [32+EBX]
   368 00000242 E8 00000008                     	CALL	_sheet_refreshsub
   369 00000247 83 C4 1C                        	ADD	ESP,28
   370 0000024A                                 L63:
   371 0000024A 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   372 0000024D C9                              	LEAVE
   373 0000024E C3                              	RET
   374 0000024F                                 	GLOBAL	_sheet_refreshsub
   375 0000024F                                 _sheet_refreshsub:
   376 0000024F 55                              	PUSH	EBP
   377 00000250 89 E5                           	MOV	EBP,ESP
   378 00000252 57                              	PUSH	EDI
   379 00000253 56                              	PUSH	ESI
   380 00000254 53                              	PUSH	EBX
   381 00000255 83 EC 2C                        	SUB	ESP,44
   382 00000258 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   383 0000025B 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   384 0000025E 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   385 00000262 8B 00                           	MOV	EAX,DWORD [EAX]
   386 00000264 8B 52 04                        	MOV	EDX,DWORD [4+EDX]
   387 00000267 89 45 DC                        	MOV	DWORD [-36+EBP],EAX
   388 0000026A 89 55 D8                        	MOV	DWORD [-40+EBP],EDX
   389 0000026D 0F 88 00000133                  	JS	L96
   390 00000273                                 L66:
   391 00000273 83 7D 10 00                     	CMP	DWORD [16+EBP],0
   392 00000277 0F 88 0000011D                  	JS	L97
   393 0000027D                                 L67:
   394 0000027D 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   395 00000280 8B 46 08                        	MOV	EAX,DWORD [8+ESI]
   396 00000283 39 45 14                        	CMP	DWORD [20+EBP],EAX
   397 00000286 7E 03                           	JLE	L68
   398 00000288 89 45 14                        	MOV	DWORD [20+EBP],EAX
   399 0000028B                                 L68:
   400 0000028B 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   401 0000028E 8B 47 0C                        	MOV	EAX,DWORD [12+EDI]
   402 00000291 39 45 18                        	CMP	DWORD [24+EBP],EAX
   403 00000294 7E 03                           	JLE	L69
   404 00000296 89 45 18                        	MOV	DWORD [24+EBP],EAX
   405 00000299                                 L69:
   406 00000299 8B 45 1C                        	MOV	EAX,DWORD [28+EBP]
   407 0000029C 8B 55 20                        	MOV	EDX,DWORD [32+EBP]
   408 0000029F 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   409 000002A2 39 D0                           	CMP	EAX,EDX
   410 000002A4 0F 8F 000000BC                  	JG	L91
   411 000002AA                                 L89:
   412 000002AA 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   413 000002AD 8B 75 F0                        	MOV	ESI,DWORD [-16+EBP]
   414 000002B0 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   415 000002B3 8B 5C B7 14                     	MOV	EBX,DWORD [20+EDI+ESI*4]
   416 000002B7 8B 75 14                        	MOV	ESI,DWORD [20+EBP]
   417 000002BA 8B 03                           	MOV	EAX,DWORD [EBX]
   418 000002BC 8B 53 10                        	MOV	EDX,DWORD [16+EBX]
   419 000002BF 89 45 E0                        	MOV	DWORD [-32+EBP],EAX
   420 000002C2 29 D1                           	SUB	ECX,EDX
   421 000002C4 89 D8                           	MOV	EAX,EBX
   422 000002C6 29 F8                           	SUB	EAX,EDI
   423 000002C8 8B 7D 18                        	MOV	EDI,DWORD [24+EBP]
   424 000002CB 2D 00000414                     	SUB	EAX,1044
   425 000002D0 29 D7                           	SUB	EDI,EDX
   426 000002D2 C1 F8 02                        	SAR	EAX,2
   427 000002D5 8B 55 0C                        	MOV	EDX,DWORD [12+EBP]
   428 000002D8 69 C0 38E38E39                  	IMUL	EAX,EAX,954437177
   429 000002DE 88 45 D7                        	MOV	BYTE [-41+EBP],AL
   430 000002E1 89 7D C8                        	MOV	DWORD [-56+EBP],EDI
   431 000002E4 8B 43 0C                        	MOV	EAX,DWORD [12+EBX]
   432 000002E7 29 C6                           	SUB	ESI,EAX
   433 000002E9 29 C2                           	SUB	EDX,EAX
   434 000002EB 89 75 E4                        	MOV	DWORD [-28+EBP],ESI
   435 000002EE 89 55 E8                        	MOV	DWORD [-24+EBP],EDX
   436 000002F1 0F 88 00000097                  	JS	L98
   437 000002F7                                 L74:
   438 000002F7 85 C9                           	TEST	ECX,ECX
   439 000002F9 0F 88 00000088                  	JS	L99
   440 000002FF                                 L75:
   441 000002FF 8B 43 04                        	MOV	EAX,DWORD [4+EBX]
   442 00000302 39 45 E4                        	CMP	DWORD [-28+EBP],EAX
   443 00000305 7E 03                           	JLE	L76
   444 00000307 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   445 0000030A                                 L76:
   446 0000030A 8B 43 08                        	MOV	EAX,DWORD [8+EBX]
   447 0000030D 39 45 C8                        	CMP	DWORD [-56+EBP],EAX
   448 00000310 7E 03                           	JLE	L77
   449 00000312 89 45 C8                        	MOV	DWORD [-56+EBP],EAX
   450 00000315                                 L77:
   451 00000315 89 CE                           	MOV	ESI,ECX
   452 00000317 3B 4D C8                        	CMP	ECX,DWORD [-56+EBP]
   453 0000031A 7D 3B                           	JGE	L93
   454 0000031C                                 L88:
   455 0000031C 8B 7B 10                        	MOV	EDI,DWORD [16+EBX]
   456 0000031F 8B 4D E8                        	MOV	ECX,DWORD [-24+EBP]
   457 00000322 01 F7                           	ADD	EDI,ESI
   458 00000324 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   459 00000327 89 7D EC                        	MOV	DWORD [-20+EBP],EDI
   460 0000032A 7D 25                           	JGE	L95
   461 0000032C                                 L87:
   462 0000032C 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   463 0000032F 8B 7D EC                        	MOV	EDI,DWORD [-20+EBP]
   464 00000332 8B 43 0C                        	MOV	EAX,DWORD [12+EBX]
   465 00000335 0F AF 7A 08                     	IMUL	EDI,DWORD [8+EDX]
   466 00000339 01 C8                           	ADD	EAX,ECX
   467 0000033B 8A 55 D7                        	MOV	DL,BYTE [-41+EBP]
   468 0000033E 01 F8                           	ADD	EAX,EDI
   469 00000340 8B 7D D8                        	MOV	EDI,DWORD [-40+EBP]
   470 00000343 89 45 CC                        	MOV	DWORD [-52+EBP],EAX
   471 00000346 38 14 38                        	CMP	BYTE [EAX+EDI*1],DL
   472 00000349 74 23                           	JE	L100
   473 0000034B                                 L84:
   474 0000034B 41                              	INC	ECX
   475 0000034C 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   476 0000034F 7C DB                           	JL	L87
   477 00000351                                 L95:
   478 00000351 46                              	INC	ESI
   479 00000352 3B 75 C8                        	CMP	ESI,DWORD [-56+EBP]
   480 00000355 7C C5                           	JL	L88
   481 00000357                                 L93:
   482 00000357 8B 75 20                        	MOV	ESI,DWORD [32+EBP]
   483 0000035A FF 45 F0                        	INC	DWORD [-16+EBP]
   484 0000035D 39 75 F0                        	CMP	DWORD [-16+EBP],ESI
   485 00000360 0F 8E FFFFFF44                  	JLE	L89
   486 00000366                                 L91:
   487 00000366 83 C4 2C                        	ADD	ESP,44
   488 00000369 5B                              	POP	EBX
   489 0000036A 5E                              	POP	ESI
   490 0000036B 5F                              	POP	EDI
   491 0000036C 5D                              	POP	EBP
   492 0000036D C3                              	RET
   493 0000036E                                 L100:
   494 0000036E 89 F0                           	MOV	EAX,ESI
   495 00000370 8B 55 E0                        	MOV	EDX,DWORD [-32+EBP]
   496 00000373 0F AF 43 04                     	IMUL	EAX,DWORD [4+EBX]
   497 00000377 01 C8                           	ADD	EAX,ECX
   498 00000379 8B 7D DC                        	MOV	EDI,DWORD [-36+EBP]
   499 0000037C 8A 04 10                        	MOV	AL,BYTE [EAX+EDX*1]
   500 0000037F 8B 55 CC                        	MOV	EDX,DWORD [-52+EBP]
   501 00000382 88 04 3A                        	MOV	BYTE [EDX+EDI*1],AL
   502 00000385 EB C4                           	JMP	L84
   503 00000387                                 L99:
   504 00000387 31 C9                           	XOR	ECX,ECX
   505 00000389 E9 FFFFFF71                     	JMP	L75
   506 0000038E                                 L98:
   507 0000038E C7 45 E8 00000000               	MOV	DWORD [-24+EBP],0
   508 00000395 E9 FFFFFF5D                     	JMP	L74
   509 0000039A                                 L97:
   510 0000039A C7 45 10 00000000               	MOV	DWORD [16+EBP],0
   511 000003A1 E9 FFFFFED7                     	JMP	L67
   512 000003A6                                 L96:
   513 000003A6 C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   514 000003AD E9 FFFFFEC1                     	JMP	L66
   515 000003B2                                 	GLOBAL	_sheet_slide
   516 000003B2                                 _sheet_slide:
   517 000003B2 55                              	PUSH	EBP
   518 000003B3 89 E5                           	MOV	EBP,ESP
   519 000003B5 57                              	PUSH	EDI
   520 000003B6 56                              	PUSH	ESI
   521 000003B7 53                              	PUSH	EBX
   522 000003B8 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   523 000003BB 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   524 000003BE 8B 7B 0C                        	MOV	EDI,DWORD [12+EBX]
   525 000003C1 8B 73 10                        	MOV	ESI,DWORD [16+EBX]
   526 000003C4 89 43 0C                        	MOV	DWORD [12+EBX],EAX
   527 000003C7 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   528 000003CA 89 43 10                        	MOV	DWORD [16+EBX],EAX
   529 000003CD 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   530 000003D1 78 7C                           	JS	L101
   531 000003D3 6A 00                           	PUSH	0
   532 000003D5 89 F0                           	MOV	EAX,ESI
   533 000003D7 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   534 000003DA 50                              	PUSH	EAX
   535 000003DB 89 F8                           	MOV	EAX,EDI
   536 000003DD 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   537 000003E0 50                              	PUSH	EAX
   538 000003E1 56                              	PUSH	ESI
   539 000003E2 57                              	PUSH	EDI
   540 000003E3 FF 73 20                        	PUSH	DWORD [32+EBX]
   541 000003E6 E8 0000008F                     	CALL	_sheet_refreshmap
   542 000003EB 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   543 000003EE FF 73 18                        	PUSH	DWORD [24+EBX]
   544 000003F1 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   545 000003F4 50                              	PUSH	EAX
   546 000003F5 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   547 000003F8 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   548 000003FB 50                              	PUSH	EAX
   549 000003FC FF 75 10                        	PUSH	DWORD [16+EBP]
   550 000003FF FF 75 0C                        	PUSH	DWORD [12+EBP]
   551 00000402 FF 73 20                        	PUSH	DWORD [32+EBX]
   552 00000405 E8 00000070                     	CALL	_sheet_refreshmap
   553 0000040A 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   554 0000040D 83 C4 30                        	ADD	ESP,48
   555 00000410 48                              	DEC	EAX
   556 00000411 50                              	PUSH	EAX
   557 00000412 89 F0                           	MOV	EAX,ESI
   558 00000414 6A 00                           	PUSH	0
   559 00000416 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   560 00000419 50                              	PUSH	EAX
   561 0000041A 89 F8                           	MOV	EAX,EDI
   562 0000041C 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   563 0000041F 50                              	PUSH	EAX
   564 00000420 56                              	PUSH	ESI
   565 00000421 57                              	PUSH	EDI
   566 00000422 FF 73 20                        	PUSH	DWORD [32+EBX]
   567 00000425 E8 FFFFFE25                     	CALL	_sheet_refreshsub
   568 0000042A 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   569 0000042D FF 73 18                        	PUSH	DWORD [24+EBX]
   570 00000430 FF 73 18                        	PUSH	DWORD [24+EBX]
   571 00000433 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   572 00000436 50                              	PUSH	EAX
   573 00000437 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   574 0000043A 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   575 0000043D 50                              	PUSH	EAX
   576 0000043E FF 75 10                        	PUSH	DWORD [16+EBP]
   577 00000441 FF 75 0C                        	PUSH	DWORD [12+EBP]
   578 00000444 FF 73 20                        	PUSH	DWORD [32+EBX]
   579 00000447 E8 FFFFFE03                     	CALL	_sheet_refreshsub
   580 0000044C 83 C4 38                        	ADD	ESP,56
   581 0000044F                                 L101:
   582 0000044F 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   583 00000452 5B                              	POP	EBX
   584 00000453 5E                              	POP	ESI
   585 00000454 5F                              	POP	EDI
   586 00000455 5D                              	POP	EBP
   587 00000456 C3                              	RET
   588 00000457                                 	GLOBAL	_sheet_free
   589 00000457                                 _sheet_free:
   590 00000457 55                              	PUSH	EBP
   591 00000458 89 E5                           	MOV	EBP,ESP
   592 0000045A 53                              	PUSH	EBX
   593 0000045B 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   594 0000045E 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   595 00000462 78 0A                           	JS	L104
   596 00000464 6A FF                           	PUSH	-1
   597 00000466 53                              	PUSH	EBX
   598 00000467 E8 FFFFFC6A                     	CALL	_sheet_updown
   599 0000046C 58                              	POP	EAX
   600 0000046D 5A                              	POP	EDX
   601 0000046E                                 L104:
   602 0000046E C7 43 1C 00000000               	MOV	DWORD [28+EBX],0
   603 00000475 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   604 00000478 C9                              	LEAVE
   605 00000479 C3                              	RET
   606 0000047A                                 	GLOBAL	_sheet_refreshmap
   607 0000047A                                 _sheet_refreshmap:
   608 0000047A 55                              	PUSH	EBP
   609 0000047B 89 E5                           	MOV	EBP,ESP
   610 0000047D 57                              	PUSH	EDI
   611 0000047E 56                              	PUSH	ESI
   612 0000047F 53                              	PUSH	EBX
   613 00000480 83 EC 28                        	SUB	ESP,40
   614 00000483 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   615 00000486 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   616 0000048A 8B 40 04                        	MOV	EAX,DWORD [4+EAX]
   617 0000048D 89 45 D8                        	MOV	DWORD [-40+EBP],EAX
   618 00000490 0F 88 00000135                  	JS	L136
   619 00000496                                 L106:
   620 00000496 83 7D 10 00                     	CMP	DWORD [16+EBP],0
   621 0000049A 0F 88 0000011F                  	JS	L137
   622 000004A0                                 L107:
   623 000004A0 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   624 000004A3 8B 42 08                        	MOV	EAX,DWORD [8+EDX]
   625 000004A6 39 45 14                        	CMP	DWORD [20+EBP],EAX
   626 000004A9 7E 03                           	JLE	L108
   627 000004AB 89 45 14                        	MOV	DWORD [20+EBP],EAX
   628 000004AE                                 L108:
   629 000004AE 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   630 000004B1 8B 46 0C                        	MOV	EAX,DWORD [12+ESI]
   631 000004B4 39 45 18                        	CMP	DWORD [24+EBP],EAX
   632 000004B7 7E 03                           	JLE	L109
   633 000004B9 89 45 18                        	MOV	DWORD [24+EBP],EAX
   634 000004BC                                 L109:
   635 000004BC 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   636 000004BF 8B 7D 1C                        	MOV	EDI,DWORD [28+EBP]
   637 000004C2 89 7D F0                        	MOV	DWORD [-16+EBP],EDI
   638 000004C5 3B 78 10                        	CMP	EDI,DWORD [16+EAX]
   639 000004C8 0F 8F 000000D6                  	JG	L131
   640 000004CE                                 L129:
   641 000004CE 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   642 000004D1 8B 55 F0                        	MOV	EDX,DWORD [-16+EBP]
   643 000004D4 8B 5D 10                        	MOV	EBX,DWORD [16+EBP]
   644 000004D7 8B 4C 96 14                     	MOV	ECX,DWORD [20+ESI+EDX*4]
   645 000004DB 89 C8                           	MOV	EAX,ECX
   646 000004DD 29 F0                           	SUB	EAX,ESI
   647 000004DF 8B 39                           	MOV	EDI,DWORD [ECX]
   648 000004E1 2D 00000414                     	SUB	EAX,1044
   649 000004E6 8B 51 10                        	MOV	EDX,DWORD [16+ECX]
   650 000004E9 C1 F8 02                        	SAR	EAX,2
   651 000004EC 89 7D E0                        	MOV	DWORD [-32+EBP],EDI
   652 000004EF 69 C0 38E38E39                  	IMUL	EAX,EAX,954437177
   653 000004F5 8B 7D 18                        	MOV	EDI,DWORD [24+EBP]
   654 000004F8 29 D3                           	SUB	EBX,EDX
   655 000004FA 29 D7                           	SUB	EDI,EDX
   656 000004FC 88 45 DF                        	MOV	BYTE [-33+EBP],AL
   657 000004FF 8B 75 14                        	MOV	ESI,DWORD [20+EBP]
   658 00000502 8B 55 0C                        	MOV	EDX,DWORD [12+EBP]
   659 00000505 8B 41 0C                        	MOV	EAX,DWORD [12+ECX]
   660 00000508 89 7D D4                        	MOV	DWORD [-44+EBP],EDI
   661 0000050B 29 C6                           	SUB	ESI,EAX
   662 0000050D 29 C2                           	SUB	EDX,EAX
   663 0000050F 89 75 CC                        	MOV	DWORD [-52+EBP],ESI
   664 00000512 89 55 E4                        	MOV	DWORD [-28+EBP],EDX
   665 00000515 0F 88 00000098                  	JS	L138
   666 0000051B                                 L114:
   667 0000051B 85 DB                           	TEST	EBX,EBX
   668 0000051D 0F 88 00000089                  	JS	L139
   669 00000523                                 L115:
   670 00000523 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   671 00000526 39 45 CC                        	CMP	DWORD [-52+EBP],EAX
   672 00000529 7E 03                           	JLE	L116
   673 0000052B 89 45 CC                        	MOV	DWORD [-52+EBP],EAX
   674 0000052E                                 L116:
   675 0000052E 8B 41 08                        	MOV	EAX,DWORD [8+ECX]
   676 00000531 39 45 D4                        	CMP	DWORD [-44+EBP],EAX
   677 00000534 7E 03                           	JLE	L117
   678 00000536 89 45 D4                        	MOV	DWORD [-44+EBP],EAX
   679 00000539                                 L117:
   680 00000539 3B 5D D4                        	CMP	EBX,DWORD [-44+EBP]
   681 0000053C 7D 54                           	JGE	L133
   682 0000053E                                 L128:
   683 0000053E 8B 71 10                        	MOV	ESI,DWORD [16+ECX]
   684 00000541 8B 55 E4                        	MOV	EDX,DWORD [-28+EBP]
   685 00000544 01 DE                           	ADD	ESI,EBX
   686 00000546 3B 55 CC                        	CMP	EDX,DWORD [-52+EBP]
   687 00000549 89 75 E8                        	MOV	DWORD [-24+EBP],ESI
   688 0000054C 7D 3E                           	JGE	L135
   689 0000054E                                 L127:
   690 0000054E 89 D8                           	MOV	EAX,EBX
   691 00000550 8B 79 0C                        	MOV	EDI,DWORD [12+ECX]
   692 00000553 0F AF 41 04                     	IMUL	EAX,DWORD [4+ECX]
   693 00000557 01 D7                           	ADD	EDI,EDX
   694 00000559 8B 75 E0                        	MOV	ESI,DWORD [-32+EBP]
   695 0000055C 01 D0                           	ADD	EAX,EDX
   696 0000055E 89 7D EC                        	MOV	DWORD [-20+EBP],EDI
   697 00000561 0F B6 34 30                     	MOVZX	ESI,BYTE [EAX+ESI*1]
   698 00000565 3B 71 14                        	CMP	ESI,DWORD [20+ECX]
   699 00000568 74 1C                           	JE	L124
   700 0000056A 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   701 0000056D 8B 45 E8                        	MOV	EAX,DWORD [-24+EBP]
   702 00000570 8B 75 D8                        	MOV	ESI,DWORD [-40+EBP]
   703 00000573 0F AF 47 08                     	IMUL	EAX,DWORD [8+EDI]
   704 00000577 03 45 EC                        	ADD	EAX,DWORD [-20+EBP]
   705 0000057A 89 45 D0                        	MOV	DWORD [-48+EBP],EAX
   706 0000057D 8A 45 DF                        	MOV	AL,BYTE [-33+EBP]
   707 00000580 8B 7D D0                        	MOV	EDI,DWORD [-48+EBP]
   708 00000583 88 04 37                        	MOV	BYTE [EDI+ESI*1],AL
   709 00000586                                 L124:
   710 00000586 42                              	INC	EDX
   711 00000587 3B 55 CC                        	CMP	EDX,DWORD [-52+EBP]
   712 0000058A 7C C2                           	JL	L127
   713 0000058C                                 L135:
   714 0000058C 43                              	INC	EBX
   715 0000058D 3B 5D D4                        	CMP	EBX,DWORD [-44+EBP]
   716 00000590 7C AC                           	JL	L128
   717 00000592                                 L133:
   718 00000592 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   719 00000595 FF 45 F0                        	INC	DWORD [-16+EBP]
   720 00000598 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   721 0000059B 3B 42 10                        	CMP	EAX,DWORD [16+EDX]
   722 0000059E 0F 8E FFFFFF2A                  	JLE	L129
   723 000005A4                                 L131:
   724 000005A4 83 C4 28                        	ADD	ESP,40
   725 000005A7 5B                              	POP	EBX
   726 000005A8 5E                              	POP	ESI
   727 000005A9 5F                              	POP	EDI
   728 000005AA 5D                              	POP	EBP
   729 000005AB C3                              	RET
   730 000005AC                                 L139:
   731 000005AC 31 DB                           	XOR	EBX,EBX
   732 000005AE E9 FFFFFF70                     	JMP	L115
   733 000005B3                                 L138:
   734 000005B3 C7 45 E4 00000000               	MOV	DWORD [-28+EBP],0
   735 000005BA E9 FFFFFF5C                     	JMP	L114
   736 000005BF                                 L137:
   737 000005BF C7 45 10 00000000               	MOV	DWORD [16+EBP],0
   738 000005C6 E9 FFFFFED5                     	JMP	L107
   739 000005CB                                 L136:
   740 000005CB C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   741 000005D2 E9 FFFFFEBF                     	JMP	L106
